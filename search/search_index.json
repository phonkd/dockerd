{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Index","text":""},{"location":"#docker","title":"Docker","text":"<p>Entries from the docker courses aren't sorted by videos but are created for topics: e.g docker compose build</p> <p>Praktische Projekte:</p> <p>Creating a new docker image</p> <p>Docker run and environement variables</p> <p>CMD vs entrypoint</p> <p>Docker registry</p> <p>Docker Compose</p> <p>Storage</p> <p>Networks</p> <p>DockerSecurity</p>"},{"location":"#ckad","title":"CKAD","text":"<p>For the udemy course i created notes for most of the videos and sorted them by topics like they are sorted in the udemy course (e.g): </p> <p>CKAD Persistent Volume</p>"},{"location":"#praktische-projekte-ckad-","title":"Praktische Projekte CKAD-","text":"<p>edit pods</p> <p>replica sets</p> <p>Deployments</p> <p>Formatting output with kubectl</p> <p>namespaces</p> <p>environement variables</p> <p>configmaps</p> <p>secrets</p> <p>Encrypting at rest</p> <p>Security context</p> <p>Service Accounts</p> <p>Resource Req</p> <p>Labels and annotations</p> <p>Taints and tolerations &amp;mor</p> <p>Multi container pods howto</p> <p>init containers</p> <p>Readiness Startup and Liveness Probes</p> <p>Container logging</p> <p>Monitoring and debugging</p> <p>Rolling updates and rollbacks</p> <p>Jobs</p> <p>Cron Jobs</p> <p>Services</p>"},{"location":"setup%20mkdocs%20%26%20pages/","title":"Setup mkdocs & pages","text":""},{"location":"setup%20mkdocs%20%26%20pages/#setup-mkdocs-local","title":"Setup mkdocs (Local)","text":"<ol> <li>Install python and pip <code>sudo pacman -S python python-pip</code></li> <li>Install mkdocs (pip) <code>pip install mkdocs-material</code> + all plugins found in mkdocs.yml</li> <li>Enable plugins in mkdocs.yml (all md plugins are build in)</li> <li>Initialize project <code>mkdocs new .</code></li> <li>Edit mkdocs.yml (e.g add theme:)</li> <li>mkdocs serve</li> </ol>"},{"location":"setup%20mkdocs%20%26%20pages/#setup-github-pages","title":"Setup github pages","text":"<ol> <li>Navigate to settings</li> <li>Scroll down to github Pages</li> <li>Change the branch to the docs folder:    </li> <li>Setup Github actions (create .github/workflows/ci.yml)</li> <li>See my ci.yml (github.com/phonkd/dockerd)</li> <li>Install dependencies <code>- run: pip install mkdocs-material pillow cairosvg mkdocs-roamlinks-plugin</code></li> <li>Create unambiguous filenames</li> </ol>"},{"location":"CKA/kritische%20shit/","title":"Kritische shit","text":"<ul> <li>[ ] Service Account, Role, RoleBinding</li> <li>[ ] Scheduling</li> <li>[ ] ??? -</li> <li>[ ] </li> </ul>"},{"location":"CKA/kubernetes%20via%20kubeadm%20vs%20manual/","title":"Kubernetes via kubeadm vs manual","text":""},{"location":"CKA/kubernetes%20via%20kubeadm%20vs%20manual/#configuring-manually-installed-component","title":"Configuring manually installed component","text":"<ol> <li>Get the binary from releases: </li> <li>Create a service what might include a config:</li> <li>Specify options</li> </ol>"},{"location":"CKA/kubernetes%20via%20kubeadm%20vs%20manual/#find-details-of-manually-installed-component","title":"Find details of manually installed component:","text":"<ul> <li>print the config: <code>cat /etc/kubernetes/manifest/kube-scheduler.yaml</code></li> <li>or list process <code>ps -aux | grep kube-scheduler</code></li> </ul>"},{"location":"CKA/deployment-types/replica%20sets/","title":"Replica sets","text":""},{"location":"CKA/deployment-types/replica%20sets/#what","title":"what","text":"<ul> <li>multiple replicas / instances of a pod running</li> </ul>"},{"location":"CKA/deployment-types/replica%20sets/#why","title":"Why?","text":"<ul> <li>for high availability (if one pod failes, another one is already there)</li> <li>Load Balancing &amp; scaling<ul> <li>Deploy more replicas according to demand<ul> <li>even on multiple nodes if one node is full</li> </ul> </li> </ul> </li> </ul>"},{"location":"CKA/deployment-types/replica%20sets/#how","title":"How","text":"<p>The replication controller is responsible for: - checking pod health - checking amount of replicas - replacing faulty pods</p>"},{"location":"CKA/deployment-types/replica%20sets/#replication-controller-vs-replica-set","title":"Replication Controller vs Replica Set","text":"<ul> <li>Replication Controller is the old version of Replica Sets</li> <li>The ReplicaSet requires a Selector (to know what pods to count)<ul> <li>whereas the replication controller doesnt require but supports them</li> </ul> </li> </ul>"},{"location":"CKA/etcd/ETCD/","title":"ETCD","text":"<p>Is a distributed reliable key-value store. Its simple and fast...</p>"},{"location":"CKA/etcd/ETCD/#what-is-a-key-value-store","title":"What is a key value Store","text":"<p>A key value Store is a sort of database that solves the problem of traditional databases.</p> <p>With traditional databases, when new information about an item is added, a new column will be created. Possibly many other items in the database dont need this new property. The result are many empty fields. </p>"},{"location":"CKA/etcd/ETCD/#how-a-key-value-store-works","title":"How a key value store works","text":"<p>In a key value store, each item gets a document. Here only the necessary properties are set: </p> <p>the advantage here being that new properties can be added to items individually.</p>"},{"location":"CKA/etcd/etcdctl/","title":"Etcdctl","text":"<p>is a tool for interacting with the ETCD key value store</p>"},{"location":"CKA/etcd/etcdctl/#api-version","title":"API Version","text":"<p>Etcdctl supports both api version 2 and 3.</p> <p>am I running etctctl version 2 or 3?</p> <p>Run  <pre><code>etcdctl --version\n</code></pre> or <pre><code>etctctl version\n</code></pre></p> <p>To change the api version used by etcdctl set the environement variable:</p> <p><pre><code>export ETCDCTL_API=3\n</code></pre> (default=2)</p>"},{"location":"CKA/kube%20proxy/kube-proxy/","title":"Kube proxy","text":"<p>is a service that is active on all noders</p> <ul> <li>It checks for services</li> <li>informs all other nodes about service</li> </ul> <p>It works by using iptables forwarding to forward the service ip into the pod network and eventually the pod ip.</p>"},{"location":"CKA/kube%20proxy/kube-proxy/#install-kube-proxy","title":"Install kube proxy","text":"<p>(manual) </p> <p>kube-proxy gets installed automatically with kubeadm</p> <p>It will put at least one pod on all nodes via a deamonset</p>"},{"location":"CKA/kube-apiserver/kubernetes%20apiserver%20%28kube-apiserver%29/","title":"Kubernetes apiserver (kube apiserver)","text":"<p>The kubernetes apiserver is responsible for authenticating requests, updating information in etcd</p>"},{"location":"CKA/kube-apiserver/kubernetes%20apiserver%20%28kube-apiserver%29/#what-happens-when-creating-a-pod","title":"what happens when creating a pod:","text":"<ol> <li><code>kube-apiserver</code> authenticates user and validates request</li> <li><code>kube-apiserver</code> updates information in ETCD</li> <li>kube-scheduler monitors <code>kube-apiserver</code> and sees unscheduled pods</li> <li>kube-scheduler schedules pod on fitting node</li> <li>kube-scheduler informs api-server about scheduling</li> <li><code>kube-apiserver</code> updates information in ETCD</li> <li><code>kube-apiserver</code> updates inforamtion in kubelet on worker node</li> <li>pod is created</li> <li>status is updated by kubelet via apiserver to ETCD</li> </ol>"},{"location":"CKA/kube-apiserver/kubernetes%20apiserver%20%28kube-apiserver%29/#installation","title":"installation","text":"<ul> <li> <p>via kubeadm (automatically)</p> </li> <li> <p>via binary (can be downloaded from k8s github)</p> </li> </ul>"},{"location":"CKA/kube-apiserver/kubernetes%20apiserver%20%28kube-apiserver%29/#viewing-api-server-options","title":"viewing api-server options","text":"<p>If kube-apiserver is running in a pod the yaml can be printed:</p> <pre><code>cat /etc/kubernetes/manifests/kube-apiserver.yaml\n</code></pre> <p>Else the options can be found from the running process or the systemd service:</p> <pre><code>cat /etc/systemd/system/kube-apiserver.service\n</code></pre> <pre><code>ps -aux | grep kube-apiserver\n</code></pre>"},{"location":"CKA/kube-controller%20manager/kube-controller%20manager/","title":"Kube controller manager","text":"<ul> <li>watches status of various components</li> <li>takes action based on status</li> </ul>"},{"location":"CKA/kube-controller%20manager/kube-controller%20manager/#controllers-in-k8s","title":"Controllers in k8s","text":"<ul> <li>Watch status</li> <li>Remediate (correct) situation (via kubernetes apiserver (kube-apiserver))</li> </ul>"},{"location":"CKA/kube-controller%20manager/kube-controller%20manager/#node-controller","title":"Node controller","text":"<ul> <li>Checks status of nodes</li> <li>It checks it every 5 seconds (<code>Node Monitor Period</code>)</li> <li>If it gets no response it waits for 40s ( <code>Node Monitor grace period</code>) and then marks it as unreachable</li> <li>if the node stays unreachable for 5 minutes (<code>POD Eviction timeout</code>) the pods on it get rescheduled on a healthy node</li> </ul>"},{"location":"CKA/kube-controller%20manager/kube-controller%20manager/#replication-controller","title":"Replication Controller","text":"<ul> <li>Watches replicasets<ul> <li>Number of replicas</li> <li>Recreates pods if they are dead</li> </ul> </li> </ul>"},{"location":"CKA/kube-controller%20manager/kube-controller%20manager/#there-are-many-other-controllers","title":"there are many other controllers:","text":""},{"location":"CKA/kube-controller%20manager/kube-controller%20manager/#install-kube-controller-manager-and-other-controllers","title":"Install kube-controller-manager (and other controllers)","text":"<p>By default all controllers are enabled, they can be manually enabled therefore disabling non enabled ones:</p> <p></p>"},{"location":"CKA/kube-scheduler/kube-scheduler/","title":"Kube scheduler","text":"<p>The scheduler does not schedule pods on the nodes, it decides on what nodes the pods should be scheduled.</p> <p>The [[kubelet]] schedules pods on the nodes</p>"},{"location":"CKA/kube-scheduler/kube-scheduler/#installing-kube-scheduler","title":"installing kube-scheduler","text":""},{"location":"CKA/kube-scheduler/manually%20schedule%20pod/","title":"Manually schedule pod","text":""},{"location":"CKA/kube-scheduler/manually%20schedule%20pod/#example","title":"example","text":"<ol> <li>stop <code>kube-scheduler</code> <code>mv /etc/kubernetes/manifests/kube-scheduler.yaml .</code></li> <li>create example pod and set <code>spec.nodeName: anynodeyouhave</code></li> </ol>"},{"location":"CKAD/ckad%20info/","title":"Ckad info","text":"<p>Diese Dokumentation enthaltet w\u00e4hrend dem CKAD udemy kurs gelerntes.</p> <p>Informationen wurden in abschnitte (A2-A...) aufgeteilt.</p>"},{"location":"CKAD/%C3%9Cbung%20notwendig/","title":"\u00dcbung notwendig","text":""},{"location":"CKAD/A2%20Core%20Concepts/Containerd%20%28nerdctl%29/","title":"Containerd (nerdctl)","text":"<p>Provides most of docker CLI features for containerd. e.g: <code>nerdctl run --name redis redis:alpine</code> (Syntax is same as docker cli)</p>"},{"location":"CKAD/A2%20Core%20Concepts/Containerd%20vs%20Docker/","title":"Containerd vs Docker","text":"<p>In the early era of containers, docker was very dominant. Kubernetes only worked with docker. After that the Open Container initiative was created. Any container engine that consists of an imagespec and a runtimespect can be used with kubernetes. Now the support for docker was dropped and peole moved to containerd</p> <p>General</p> <p>containerd is only the container runtime while as docker also runs containerd but with additional tools like the Docker CLI. CLI for containerd: Containerd (nerdctl)))).md) Crictl ctr] </p>"},{"location":"CKAD/A2%20Core%20Concepts/Crictl/","title":"Crictl","text":"<p>Not a replacement for docker cli but more useful for debugging.</p> <p>Crictl</p> <p>Is aware of pods: <pre><code>crictl pods\n</code></pre></p> <p></p>"},{"location":"CKAD/A2%20Core%20Concepts/Deployment%20%28recap%29/","title":"Deployment (recap)","text":"<p>Rolling update (Deployment)))).md)</p>"},{"location":"CKAD/A2%20Core%20Concepts/Multi-Container%20POD%27s/","title":"Multi Container POD's","text":"<p>Helper Containers</p> <p>Sometimes one instance of an application needs more than one container:  In that case you don't create multiple pods but multiple containers in one pod.</p> <p>To run more instances of an applications</p> <p>Dont increase the amount of containers but the amount of pods.</p>"},{"location":"CKAD/A2%20Core%20Concepts/Namespaces/","title":"Namespaces","text":"<p>All done before this point in the course was done in the default namespace</p> <p>When should i use namespaces</p> <ul> <li>[x] Production environement</li> <li>[ ] Personal use Example: Have a dev and a prod environement on one cluster: </li> </ul>"},{"location":"CKAD/A2%20Core%20Concepts/Namespaces/#namespace-capabilities","title":"Namespace capabilities","text":"<ul> <li>Policies:<ul> <li>Resource Limits</li> </ul> </li> </ul>"},{"location":"CKAD/A2%20Core%20Concepts/Namespaces/#dns","title":"DNS","text":"<ul> <li>Ressources inside a namespace can communicate via the hostname</li> <li>To connect to ressources outside a namespace use <code>hostname.namespace.svc.cluster.local</code></li> </ul>"},{"location":"CKAD/A2%20Core%20Concepts/Namespaces/#useful-commands","title":"Useful commands","text":"<p>List pods on other namespace: <code>kubectl get pods --namespace=dev **List pods on all namespaces:**</code>kubectl get pods --all-namespaces Create pod on other namespace: - <code>kubectl create -f pod-definition.yml --namespace=dev</code> or <pre><code>...\nmetadata:\nnamespace: dev\n</code></pre></p>"},{"location":"CKAD/A2%20Core%20Concepts/Namespaces/#create-namespcaes","title":"Create namespcaes:","text":""},{"location":"CKAD/A2%20Core%20Concepts/Namespaces/#by-file","title":"By file:","text":"<pre><code>apiVersion: v1\nkind: Namespace\nmetadata:\n name: dev\n</code></pre> <p>`kubectl create -f namespace-dev.yml</p>"},{"location":"CKAD/A2%20Core%20Concepts/Namespaces/#by-command","title":"By command:","text":"<p><code>kubectl create namespace dev</code></p>"},{"location":"CKAD/A2%20Core%20Concepts/Namespaces/#switch-namespace-permanentely","title":"Switch namespace permanentely","text":"<p><code>kubectl config set-context $(kubectl config current-context) --namespace=dev</code></p>"},{"location":"CKAD/A2%20Core%20Concepts/Pod%20%28recap%29/","title":"Pod (recap)","text":"<ul> <li>Pods</li> </ul>"},{"location":"CKAD/A2%20Core%20Concepts/Replica%20sets%20%28recap%29/","title":"Replica sets (recap)","text":"<p>replica sets replace yml file Scale: <pre><code>kubectl scale replicaset name --replicas=5\n</code></pre></p>"},{"location":"CKAD/A2%20Core%20Concepts/Resource%20Quota/","title":"Resource Quota","text":"<p>are used to limit ressources in a namespace</p>"},{"location":"CKAD/A2%20Core%20Concepts/Resource%20Quota/#example-yaml","title":"Example yaml","text":"<p>Compute-quota.yaml <pre><code>apiVersion: v1\nkind: ResourceQuota\nmetadata:\n name: compute-quota\n namespace: dev\nspec:\n pods: \"10\"\n requests.cpu: \"4\"\n limits.cpu: \"10\"\n limits.memory: 10Gi\n</code></pre> `kubectl create -f compute-quota.yaml</p>"},{"location":"CKAD/A3%20Configuration/CKAD%20Config%20Maps/","title":"CKAD Config Maps","text":"<p>Usecase</p> <p>In an environement with many pod definition yaml files, storing all Environment variables can be tedious and time consuming. A config map is a file containing environement variables</p>"},{"location":"CKAD/A3%20Configuration/CKAD%20Config%20Maps/#info-about-config-map","title":"Info about config map","text":"<p><code>kubectl get configmaps</code> <code>kubectl describe configmaps</code></p> <p>Its smart to seperate config maps for different pods: </p>"},{"location":"CKAD/A3%20Configuration/CKAD%20Config%20Maps/#inject-config-map-to-pod","title":"Inject config map to pod:","text":"<p>use it</p> <ol> <li>Add the <code>envFrom:</code> property under containers: <pre><code>...\nspec:\n containers:\n - name: simple-webapp-color\n   image: simple-webapp-color\n   ports:\n    - containerPort: 8080\n   envFrom:\n    - configMapRef:\n       name: app-config-map (metadata name of config map)\n</code></pre></li> <li>config-map.yaml: <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n name: app-config\ndata:\n APP_COLOR: blue\n</code></pre></li> </ol> <p>Above example will</p> <ul> <li>Set the environement variable <code>APP_COLOR:</code> to <code>blue</code> </li> </ul> <p>use a single environement variable</p> <p>Pod-yaml: ```yaml ... env: - name: APP_COLOR  valueFrom</p> <p><code>kubectl create configmap</code></p>"},{"location":"CKAD/A3%20Configuration/CKAD%20Config%20Maps/#imperative-commands","title":"Imperative (commands):","text":"<p>Create configmap with 2 keyvalue pairs:</p> <p><code>kubectl create configmap app-config --from-literal=APP_COLOR=blue --from-literal=MOD=prod</code></p> <p>Create config map from file: <code>kubectl create configmap --from-file=</code>path</p>"},{"location":"CKAD/A3%20Configuration/CKAD%20Config%20Maps/#declarative-yaml","title":"Declarative (yaml):","text":""},{"location":"CKAD/A3%20Configuration/CKAD%20Config%20Maps/#example","title":"Example:","text":"<pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n name: app-config\n data:\n  APP_COLOR: blue\n  APP_MODE: prod\n</code></pre> <p><code>kubectl create -f config-map.yml</code></p>"},{"location":"CKAD/A3%20Configuration/CKAD%20Kubernetes%20Security%20Contexts/","title":"CKAD Kubernetes Security Contexts","text":"<p>Just like in DockerSecurity, Linux capabilities can be added or Removed from a container. If security properties are applied to a pod, it will be applied to all containers inside the pod. </p> Warning <p>Linux Capabilities can only be applied to Containers ,not to pods. The <code>runAsUser</code> property cant accept root but uses <code>0</code> for it.</p> <p>If contexts are applied to both container and pod level</p> <p>The container level one counts.</p>"},{"location":"CKAD/A3%20Configuration/CKAD%20Kubernetes%20Security%20Contexts/#example-yaml-file","title":"Example Yaml File","text":""},{"location":"CKAD/A3%20Configuration/CKAD%20Kubernetes%20Security%20Contexts/#pod-level","title":"Pod Level","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n name: web-pod\nspec:\n securityContext:\n  runAsUser: 1000\n\n containers:\n  - name: ubuntu\n    image: ubuntu\n    command: [\"sleep\". \"3600\"]\n</code></pre>"},{"location":"CKAD/A3%20Configuration/CKAD%20Kubernetes%20Security%20Contexts/#container-level","title":"Container Level:","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n name: web-pod\nspec:\n  containers:\n  - name: ubuntu\n    image: ubuntu\n    command: [\"sleep\". \"3600\"]\n    securityContext:\n     runAsUser: 1000\n     capabilities:\n      add: [\"KILL\"]\n</code></pre>"},{"location":"CKAD/A3%20Configuration/CKAD%20Kubernetes%20Security%20Contexts/#disable-system-capabilities","title":"Disable system capabilities","text":""},{"location":"CKAD/A3%20Configuration/CKAD-DockerSecurity/","title":"CKAD DockerSecurity","text":"<p>Processes</p> <p>Processes run inside a docker container are visible on the docker host but with a different PID.</p>"},{"location":"CKAD/A3%20Configuration/CKAD-DockerSecurity/#users","title":"Users","text":"<p>Users &amp; Linux Capabilities</p> <p>By default processes in a container are run as root. This process however does not have full root privileges on the docekr host, because docker limits them. It is possible to add or remove capabilities such as <code>kill</code> <code>docker run --cap-add KILL</code> <code>docker run --cap-drop KILL</code> This can be changed by using <code>docker run --user=1000</code> or in the image like this: <pre><code>FROM Ubuntu\nUSER 1000\n</code></pre></p> <p>^75e1ad</p>"},{"location":"CKAD/A3%20Configuration/CKAD-DockerSecurity/#tips","title":"Tips","text":"<p>Security Tips</p> <ol> <li>Change the user from root to another</li> <li>drop unnessecary </li> </ol>"},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/","title":"CKAD ServiceAccounts","text":""},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#basics","title":"Basics","text":"<p>2 User Types</p> <p>There are two user types: User: Human (e.g admin or developer) Service: Machine (e.g Prometheus Monitoring or jenkins)</p>"},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#wtf-why-does-the-course-teach-old-stuff-that-doesnt-exist-anymore-","title":"wtf why does the course teach old stuff that doesnt exist anymore-","text":""},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#service-accounts","title":"Service Accounts","text":"<p>An application like Prometheus needs to be authenticated to access the kube-api. For that a service account can be used.</p>"},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#create-service-account","title":"Create Service account","text":"<p><code>kubectl create serviceaccount serviceaccountname</code></p> <p>No longer true (no token is generated!!) goto Create token for serviceaccount</p> <p>This automatically creates a token. This token is stored as a secret object. Find the tokens secret with the command <code>kubectl describe serviceaccount name</code>. Find the secret with the command <code>kubectl describe secret name-token-name-name</code></p> <p>In a monitoring application such as prometheus, this token can be copied and pasted into the application.</p>"},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#mount-serviceaccount-in-definition-file","title":"Mount serviceaccount in definition file:","text":"<p>Warning</p> <p>The pod cant be edited and must be recreated.</p> <pre><code>...\nspec:\n containers:\n serviceAccountName: serviceaccountname\n</code></pre>"},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#disable-default-serviceaccounttoken","title":"Disable default serviceaccounttoken","text":"<pre><code>...\nspec:\n containers:\n automountServiceAccountToken: false\n</code></pre>"},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#list-token-from-inside-of-pod","title":"List token from inside of pod","text":"<p>`kubectl exec -it my-kubernetes-pod cat /var/run/secrets/kubernetes.io/serviceaccount/token</p>"},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#update","title":"Update","text":""},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#create-serviceaccount","title":"Create serviceaccount:","text":"<p><code>kubectl create serviceaccount dashboard-sa</code></p>"},{"location":"CKAD/A3%20Configuration/CKAD-ServiceAccounts/#create-token-for-serviceaccount","title":"Create token for serviceaccount","text":"<p><code>kubectl create token dashboard-sa</code></p>"},{"location":"CKAD/A3%20Configuration/Commands%20and%20arguments%20%28k8s%29/","title":"Commands and arguments (k8s)","text":""},{"location":"CKAD/A3%20Configuration/Commands%20and%20arguments%20%28k8s%29/#entrypoint-and-args-in-k8s","title":"Entrypoint and args in k8s:","text":"<ul> <li>The <code>args: [\"\"]</code> contains the arguments which will be put after the entrypoint command (<code>CMD[\"\"]</code>).</li> <li>The <code>command: [\"\"]</code> overwrites the command specified in the entrypoint <pre><code>FROM ubuntu\nENTRYPOINT[\"sleep\"]\nCMD [\"5\"]\n</code></pre> Pod yml: <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n name: ubuntu-sleeper-pod\nspec:\n containers:\n  - name: ubuntu-sleeper\n    image: ubuntu-sleeper\n    args:[\"10\"]\n    command:[\"other-command\"]\n</code></pre></li> </ul>"},{"location":"CKAD/A3%20Configuration/Docker%20stuff/","title":"Docker stuff","text":"<p>Docker run Dockerfile CMD &amp; Entrypoint</p>"},{"location":"CKAD/A3%20Configuration/Environment%20variables%20k8s/","title":"Environment variables k8s","text":"<p>Environement variables in k8s</p>"},{"location":"CKAD/A3%20Configuration/ckad%20node%20Selectors/","title":"ckad node Selectors","text":""},{"location":"CKAD/A3%20Configuration/ckad%20node%20Selectors/#label-node","title":"Label node","text":"<p><code>kubectl label nodes node-name size=large</code></p>"},{"location":"CKAD/A3%20Configuration/ckad%20node%20Selectors/#pod-definition","title":"Pod Definition","text":"<ol> <li>add section <code>nodeSelector:</code> in pod definition yml</li> <li>Specify labels (must be applied on node) e.g <code>size: Large</code></li> </ol> <p>Limitations</p> <p>You can't have a Node selector that makes pods not go to a specific node. for this use ckad node affinity</p>"},{"location":"CKAD/A3%20Configuration/ckad%20node%20affinity/","title":"Ckad node affinity","text":"<p>Ensure Pods are hosted on particular nodes. (Complicated AF)</p> <p>To achieve the same selecter with node affinity (the one from ckad node Selectors) this section needs to be added to the pod definition yaml:</p>"},{"location":"CKAD/A3%20Configuration/ckad%20node%20affinity/#examples","title":"Examples","text":"<p>Put pods on nodes with key/value pair size=large</p> <pre><code>...\nspec:\n affinity:\n  nodeAffinity:\n   requiredDuringSchedulingIgnoredDuringExecution:\n    nodeSelectorTerms:\n    - matchExpressions:\n      - key: size\n        operator: In\n        values:\n        - Large\n</code></pre> <p>Put pods on nodes with kv pair size=large or size=medium</p> <pre><code>...\n...\nvalues:\n- Large\n- Medium\n</code></pre> <p>Dont put pods on nodes with kv pair:</p> <pre><code>...\n...\n- matchExpressions:\n  - key: size\n    operator: NotIn\n    values:\n    - Small\n</code></pre>"},{"location":"CKAD/A3%20Configuration/ckad%20node%20affinity/#node-affinity-types","title":"Node Affinity Types","text":"<p><code>requiredDuringSchedulingIgnoredDuringExecution</code></p> <p>If the specified Node cannot be found, the pod will not be scheduled.  If for example the kv pair <code>size=large</code> gets removed from the node during runtime, nothing happens because its set to ignored. Changes in node affinity will not affect already placed pods.</p> <p><code>preferedDuringSchedulingIgnoredDuringExecution</code></p> <p>Place the pod on the specified node but if it does not exist just place it on another node. Removing the kv pair is the same as before.</p> <p><code>requiredDuringSchedulingRequiredDuringExecution</code></p> <p>Changing node affinity will affect pods in runtime.</p>"},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/","title":"Ckad resource requirements","text":""},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/#the-problem","title":"The problem","text":"<p>Warning</p> <p>By default a pod can consume all of the hosts resources and suffocate other processes on the host or other pods. It therefore is a good idea to limit CPU and Memory of a container inside a pod. <pre><code>...\ncontainers:\n...\nresources:\n requests:\n  memory: \"1Gi\"\n  cpu: 1\n limits:\n  memory: \"2Gi\"\n  cpu: 2\n</code></pre></p> <p>Kube Scheduler</p> <p>The kube Scheduler looks at resource requirements of a pod and distributes pods across nodes efficiently: </p>"},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/#set-specifig-resource-requirements-on-pod","title":"set specifig resource requirements on pod","text":"<pre><code>...\nkind: Pod\n...\ncontainers:\n...\n resources:\n  requests:\n   memory: \"4Gi\"\n   cpu: 2\n</code></pre> <p>what is 1 CPU</p> <p>Possible values 0.1 or 100mili 1 CPU =  - 1 AWS vCPU - 1 GCP Core - 1 Azure Core - 1 Hyperthread</p> <p>Memory</p> <p>Can be specified like this - 1G (1 Gigabyte) - 1M (1 Megabyte) - 1K (1 Kilobyte) or: - 1Gi (1 Gibibyte) and so on</p>"},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/#exceding-limits","title":"Exceding limits:","text":"<p>A container cannot exceed a CPU limit.</p> <p>It can however exceed the memory limit. If it does so repeatedly it will be terminated with a out of memory error.</p>"},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/#default-behavior","title":"Default Behavior","text":"<p>Request only (best choice)</p> <p>Each pod gets some amount of resources (request). Pods can also use more resources if available but only to an extent that still all pods get their requested resources.</p> <p>^1360f2</p>"},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/#cpu","title":"CPU","text":"<p>By default any pod can use all of the resources available and suffocate other pods or system processes.</p> <p> Right model requires all pods to have requests defined for them to get resources.</p>"},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/#memory","title":"Memory","text":"<p>Just like with CPU, one pod can consume all the memory available and hinder other processes.</p> <p></p>"},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/#limit-ranges","title":"Limit Ranges","text":"<p>*Set limits and request that get applied to pods if they dont specifically have defined limits.</p> <pre><code>apiVersion: v1\nkind: LimitRange\nmetadata:\n name: cpu-resource-constraint\nspec:\n limits:\n - default:\n    cpu: 500m\n   defaultRequest:\n    cpu: 500m\n   max:\n    cpu: \"1\"\n   min:\n    cpu: 100m\n   type: Container\n</code></pre> <p></p>"},{"location":"CKAD/A3%20Configuration/ckad-resource-requirements/#limit-total-usage-of-all-pods-resource-quotas","title":"Limit Total usage of all pods (Resource Quotas)","text":"<p>Limit resources in current namespace:</p> <p>```yaml apiVersion: v1 kind: ResourceQuota metadata:  name: my-resource-quota spec:  hard:   requests.cpu: 4   requests.memory: 4Gi   limits.cpu: 10   limits.memory: 10Gi</p>"},{"location":"CKAD/A3%20Configuration/config%20maps%20%28CKAD%29/","title":"config maps (CKAD)","text":"<p>Can either be created via a yaml file or by the command </p> <p>CKAD Config Maps</p>"},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/","title":"secrets (CKAD)","text":"<p>t****</p> <p>Warning</p> <p>Secrets are encoded and not encrypted</p> <p>*<code>kubectl get secret -o yaml</code></p> <p>Why use secrets when we have config maps</p> <p>Storing data like a <code>DB_host</code> or a <code>DB_User</code> can easily be done using config maps.</p> <p>However for storing data like <code>DB_password</code> using secrets is the correct approach.</p>"},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/#setup-secrets","title":"setup secrets","text":""},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/#create-secret","title":"Create secret","text":""},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/#imperative","title":"Imperative","text":"<p><code>kubectl create secret generic secret-name --from-literal=KEY=VALUE --from-literal=DB_User=root</code></p> <p>By file:</p> <p>`kubectl create secret generic name-secret --from-file=app_secret.properties</p>"},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/#declarative","title":"Declarative","text":"<pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n name: app-secret\ndata:\n DB_host: mysql\n DB_User: root\n DB_Password: 123\n</code></pre> Warning <p>The data must be encoded.</p> <p>Info</p> <p>Encode base 64:</p> <p><code>echo -n '123' | base 64</code></p> <p>Decode:</p> <p><code>echo -n '123' | base64 --decode</code></p>"},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/#inject-it-into-pad","title":"Inject it into pad","text":""},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/#all-secrets-as-env","title":"All secrets as env","text":"<pre><code>...\nspec:\n containers:\n - name: simple-webapp-color\n   image: simple-webapp-color\n   envFrom:\n    - secretRef:\n       name: secret-name\n</code></pre> <p>This will make all secrets in the secret work like environement variables in the pod.</p>"},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/#single-secret","title":"Single secret:","text":"<pre><code>...\n...\nenv:\n - name: DB_password\n   valueFrom:\n    secretKeyRef:\n     name: app-secret\n     key: DB_password\n</code></pre>"},{"location":"CKAD/A3%20Configuration/secrets%20%28CKAD%29/#mount-secret-as-volume","title":"Mount secret as volume","text":"<pre><code>spec:\n      containers:\n      - image: phonkd/t-practice:2\n        name: t-practice\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n           name: confmap1\n        - secretRef:\n           name: maisegret\n        volumeMounts:\n          - name: htmlsecret\n            mountPath: /var/www/html/index.html\n            subPath: index.html\n      volumes:\n        - name: htmlsecret\n          secret:\n            secretName: a8-html-secret\n</code></pre>"},{"location":"CKAD/A3%20Configuration/taints%20and%20tolerations/","title":"Taints and tolerations","text":"<p>Are used to restrict pods of being deployed on a node. It does not force pods to go to a node. </p>"},{"location":"CKAD/A3%20Configuration/taints%20and%20tolerations/#example","title":"Example","text":"<p>If 3 nodes are given but one has specific resourecs that fit one kind of pod:</p> <p>a taint can be applied to that node. This makes it so no pods will be put on that node If the taint is also applied to the pod (as Toleration) it will then go to the node.</p> <p>Taints are set on nodes Tolerations are set on pods</p>"},{"location":"CKAD/A3%20Configuration/taints%20and%20tolerations/#syntax","title":"syntax","text":""},{"location":"CKAD/A3%20Configuration/taints%20and%20tolerations/#add-taints-to-node","title":"add taints to node","text":"<p><code>kubectl taint nodes node-name key=value:taint-effect</code></p> <p>taint-effect must be replaced with: - <code>NoSchedule</code> no intolerant pod on this node - <code>PreferNoSchedule</code> only pods created before the taint - <code>NoExecute</code> idk</p>"},{"location":"CKAD/A3%20Configuration/taints%20and%20tolerations/#add-tolerations-to-pod","title":"add Tolerations to pod:","text":"<p>given:</p> <p>`kubectl taint nodes node1 app=blue:NoSchedule</p> <pre><code>...\nkind: Pod\n...\nspec:\n containers:\n ...\n tolerations:\n - key: app\n   opearator: \"Equal\"\n   value: \"blue\"\n   effect: \"NoSchedule\"\n</code></pre>"},{"location":"CKAD/A3%20Configuration/taints%20and%20tolerations/#remove-taint-from-node","title":"Remove taint from node","text":"<p><code>kubectl taint nodes controlplane node-role.kubernetes.io/control-plane:NoSchedule-</code></p>"},{"location":"CKAD/A4%20Multi-Container-Pods/Microservices/","title":"Microservices","text":"<p>Big application split into microservices. This simplifies the scaling process.</p>"},{"location":"CKAD/A4%20Multi-Container-Pods/ckad%20init%20containers/","title":"Ckad init containers","text":"<p>Normally all containers inside a pod run as long as the pod does. The Services are often continuous and dont stop running (Web Server, logging).</p> <p>To create a container that runs a simple JOB once and then stops, use ckad init containers. (on pod creation)</p> <p>Possibilities</p> <p>Its possible to specify multiple init containers.</p> <p>Example yaml:</p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp-pod\n  labels:\n    app: myapp\nspec:\n  containers:\n  - name: myapp-container\n    image: busybox:1.28\n    command: ['sh', '-c', 'echo The app is running! &amp;&amp; sleep 3600']\n  initContainers:\n  - name: init-myservice\n    image: busybox\n    command: ['sh', '-c', 'git clone &lt;some-repository-that-will-be-used-by-application&gt;\u00a0;']\n</code></pre>"},{"location":"CKAD/A4%20Multi-Container-Pods/ckad-multicontainer%20Pods/","title":"ckad multicontainer Pods","text":"<p>Sometimes you need more than one container (service) to work together. It sometimes is a best practice to keep the two services seperated instead of creating one big service.</p>"},{"location":"CKAD/A4%20Multi-Container-Pods/ckad-multicontainer%20Pods/#design-patterns","title":"Design Patterns:","text":""},{"location":"CKAD/A4%20Multi-Container-Pods/ckad-multicontainer%20Pods/#sidecar","title":"Sidecar:","text":"<p>Useful for collecting log data from a webserver and sending it to a log server.</p> <p></p>"},{"location":"CKAD/A4%20Multi-Container-Pods/ckad-multicontainer%20Pods/#adapter","title":"Adapter:","text":"<p>Since different application might have different data outputs, an adapter is used to unify the outputs and send them to the server.</p>"},{"location":"CKAD/A4%20Multi-Container-Pods/ckad-multicontainer%20Pods/#ambassador","title":"Ambassador","text":""},{"location":"CKAD/A4%20Multi-Container-Pods/ckad-multicontainer%20Pods/#example-yaml","title":"Example yaml","text":"<pre><code>...\n</code></pre>"},{"location":"CKAD/A5%20Observability/CKAD%20Liveness%20Probes/","title":"CKAD Liveness Probes","text":"<p>In Kubernetes if a pod is running, kubernetes assumes it's working. Sometimes additional probes make sense to really verify that the users don't get routed to a non working pod.</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Liveness%20Probes/#how","title":"How","text":"<p>To configure Liveness Probes, configure them exactly like CKAD Readiness Probes but just change <code>readinessProbe</code> to <code>livenessProbe:</code>.</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Monitoring%20and%20Debugging/","title":"CKAD Monitoring and Debugging","text":"<p>Info</p> <p>Kubernetes does not include a full monitoring solution.</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Monitoring%20and%20Debugging/#metrics-server","title":"Metrics Server","text":"<p>Metrics press ctrl *The Metrics Server retrieves Metrics from each of the kubernetes nodes and pods, aggregates them and stores them in memory.</p> <p>Metrics Server IN-MEMORY</p> <p>The Metrics server only stores data in memory and not on the disk. Therefore it alone is no solution for monitoring e.g monthly usage. Use Prometheus</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Monitoring%20and%20Debugging/#theory-boring-af","title":"Theory (boring af)","text":"<p>The containerAdvisor (Cadvisor) is a component of the KUBELET (agent).</p> <p>The cAdvisor collects data and exposes it to the metrics server via the kube API.</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Monitoring%20and%20Debugging/#getting-started","title":"Getting Started:","text":"<p><code>kubectl top node</code> Performance metrics of nodes</p> <p><code>kubectl top pod</code> view performance metrics of pod</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/","title":"CKAD Readiness Probes","text":"<p>IF a pod falsely gets labeled as ready, traffic will be directed to it, even tho it does not yet fully work.</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/#pod-status","title":"Pod Status","text":"<p>High level summary of POD</p> <p><code>Pending</code></p> <p><code>Running</code> </p> <p><code>ContainerCreating</code></p>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/#pod-conditions","title":"Pod Conditions","text":"<p>Array of True or false values aboutt the pod</p> <p></p>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/#the-ready-condition","title":"the Ready Condition:","text":"<p>Implicates that the POD is ready, its service/Application is running.</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/#readiness-probe","title":"Readiness Probe","text":"<p>Change the conditions a pod must meet in order to show up as ready.</p>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/#example-with-httpget","title":"Example with <code>httpGet:</code>","text":"<pre><code>...\nspec:\n containerse:\n  ...\n  readinessProbe:\n   httpGet:\n    path: /api/ready\n    port: 8080\n</code></pre>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/#example-with-tcpsocket","title":"Example with <code>tcpSocket:</code>","text":"<pre><code>readinessProbe:\n tcpSocket:\n  port: 3306\n</code></pre>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/#example-with-exec","title":"Example with <code>exec:</code>","text":"<pre><code>readinessProbe:\n exec:\n  command:\n   - cat\n   - /app/is_ready\n</code></pre>"},{"location":"CKAD/A5%20Observability/CKAD%20Readiness%20Probes/#options","title":"Options","text":"<p><code>initialDelaySeconds:</code> Waits 10 seconds before testing.</p> <p><code>periodSeconds:</code> frequency of tests</p> <p><code>failureThreshold:</code> how many times it will be tested</p>"},{"location":"CKAD/A5%20Observability/CKAD%20container%20logging/","title":"CKAD container logging","text":"<p>Just like <code>docker logs</code> you can use <code>kubectl logs pod-name</code> To see them in real time use <code>kubectl logs -f pod-name</code></p> <p>Multi container Pods</p> <p>When multiple containers are inside a pod, the container name must be specified. <code>kubectl logs -f pod-name container-name</code></p>"},{"location":"CKAD/A5%20Observability/Prometheus/","title":"Prometheus","text":"<p>An OpenSource Monitoring solution that can use Kubernetes's  to collect data.</p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Annotations/","title":"CKAD Annotations","text":"<p>annotation</p> <p>Annotations are used to add notes and comments.</p> <p>Example:</p> <pre><code>...\nmetadata:\n name: simple-webapp\n labels:\n  app: App1\n annotations:\n  buildversion: 1.34\n</code></pre>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Jobs/","title":"CKAD Jobs","text":"<p>Many workloads are permanent. An example would be websites and databases.</p> <p>Jobs however do something and when done destroy. (e.g Math operation)</p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Jobs/#kubernetes-vs-docker","title":"Kubernetes vs Docker","text":"<p>Docker:</p> <p>To run a container, calculate 10 + 5 run:</p> <p><code>docker run ubuntu expr 10 + 5</code></p> <p>The container will exit (0)</p> <p></p> <p>Kubernetes</p> <p>In kubernetes this pod will be restarted infinitely.</p> <p>This is because of the <code>restartPolicy: Always</code>(default) property under the  <code>spec:</code> section.</p> <p>Set it to <code>never</code> or to <code>onFailure</code> to disable restarting.</p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Jobs/#create-jobs","title":"Create Jobs","text":"<p>Jobs are useful for orchestrating pods for tasks.</p> <pre><code>apiVersion: batch/v1\nkind: Job\nmetadata:\n name: math-add-job\nspec:\n completions: 3\n template:\n  spec:\n   containers:\n    - name: math-add\n      image: ubuntu\n      command: ['expr', 'r', '+', '2']\n   restartPolicy: Never\n</code></pre> <p>Kubernetes will create Pods as long as there arent 3 successfull completions:</p> <p></p> <p>with the <code>parallelism: 3</code> property, 3 pods are created in paralell.</p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Jobs/#specbackofflimit-property","title":"<code>spec.backofflimit:</code> property","text":"<p>How many times a pod can fail before k8s gives up.</p> <p>Can be useful to prevent infinite failing pods.</p> <pre><code>spec:\n backofflimit: 10\n template:\n  spec:\n</code></pre>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Kubernetes%20Cron%20Jobs/","title":"CKAD Kubernetes Cron Jobs","text":"<p>Schedule Jobs</p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Kubernetes%20Cron%20Jobs/#create-a-cron-job-definitinoyml-file","title":"Create a cron-job-definitino.yml file","text":"<p><code>yaml apiVersion: batch/v1beta1 kind: CronJob metadata:  name: reportin-cron-job spec:   schedule: \"*/1 * * * *\"  jobTemplate:   spec:    completions: 3    paralellism: 3    template:     spec:      containers:       - name: reporting-tool         image: reporting-tool      restartPolicy: Never</code></p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Labels%20and%20Selectors/","title":"CKAD Labels and Selectors","text":"<p>select pod with multiple conditions:</p> <p><code>k get pods --selector env=prod,bu=finance,tier=frontend</code></p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Labels%20and%20Selectors/#huh","title":"Huh","text":"<p>Labels and selectors are a standart method to grofup things together. They group and filter stuff based on some criteria.</p> <p>Labels and selectors are also used internally by kubernetes objects. An example of this are replica sets: They know which pods to count in by labels.</p> <p>Watch out for this mistake</p> <p>The first labels in the file are the labels of the replica set.</p> <p>The ones in the template section are from the pods!</p> <p></p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Labels%20and%20Selectors/#add-labels-to-stuff","title":"Add labels to stuff","text":"<pre><code>...\nmetadata:\n name: my-app\n labels:\n  app: App1\n  function: Front-end\n  Literallyanything: ihavenoidea\n</code></pre>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Labels%20and%20Selectors/#select-resources-with-label","title":"Select resources with label","text":"<p><code>kubectl get pods --selector function=front-end</code></p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Updates%20and%20Rollbacks/","title":"CKAD Updates and Rollbacks","text":""},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Updates%20and%20Rollbacks/#rollout-and-versioning","title":"Rollout and versioning","text":"<p>When you create a deployment, a new rollout is created.</p> <p>The rollout creates a revision.</p> <p>On Update a new revision is created.</p> <p>This enables an easy rollback.</p> <p></p> <p>View rollout status:</p> <p><code>kubectl rollout status deployment-name</code></p> <p>View Revisions:</p> <p><code>kubectl rollout history deployment-name</code></p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Updates%20and%20Rollbacks/#deployment-strategies","title":"Deployment Strategies","text":""},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Updates%20and%20Rollbacks/#recreate-strategy","title":"Recreate Strategy:","text":"<p>Destroy all old pods and recreate new ones. (Shit bc of downtime)</p> <p></p> <p></p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Updates%20and%20Rollbacks/#rolling-update-default","title":"Rolling Update (Default)","text":"<p>Destroy single pods 1by1 and create pods with the new version.</p> <p>Kubernetes creates a new replicasets and scales the old one down one  by one while increasing the replicas by 1 in the new replicaset.</p> <p></p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Updates%20and%20Rollbacks/#create-deployment","title":"Create Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n name: myapp-deployment\n labels:\n  app: myapp\n  type: front-end\nspec:\n template:\n  metadata:\n   name: myapp-pod\n   labels:\n    app: myapp\n    type: frontend\n  spec:\n   containers:\n   - name: nginx-container\n     image: nginx:1.7.1\n  replicas: 3\n  selector:\n   matchLabels:\n    type: front-end\n</code></pre> <p><code>kubectl apply -f yaml.yml</code></p>"},{"location":"CKAD/A6%20Pod%20%20Design/CKAD%20Updates%20and%20Rollbacks/#rollback","title":"Rollback","text":"<p>This will scale the new replica set back down and the old one back up.</p> <p><code>kubectl rollout undo deployment-name</code></p> <p>To rollback to specific revision we will use the <code>--to-revision</code> flag.</p>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20Cluster%20IP/","title":"CKAD Cluster IP","text":"<p>ClusterIP</p>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/","title":"CKAD ingress Networking","text":"<p><code>k create ingress ingress-pay -n critical-space --rule=\"/pay=pay-service:8282\"</code></p>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#rewrite-annotations","title":"Rewrite annotations","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n name: test-ingress\n namespace: critical-space\n annotations:\n  nginx.ingress.kubernetes.io/rewrite-target:/\n</code></pre>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#hell-no-networking","title":"Hell no networking","text":"<p>Instead of having all of this crap:</p> <p></p> <p>You are better off setting up an ingress Controller in Kubernetes.</p> <p>It involves creating a deployment of one of the following Services:</p> <p></p>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#how-to-setup-ingress","title":"How to setup ingress","text":""},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#or","title":"Or","text":"<p><code>kubectl create ingress &lt;ingress-name&gt; --rule=\"host/path=service:port\"</code></p>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#1-create-deployment","title":"1. Create Deployment","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n name: nginx-ingress-controller\nspec:\n replicas: 1\n selector:\n  matchLabels:\n   name: nginx-ingress\n template:\n  metadata:\n   labels:\n    name: nginx-ingress\n  spec:\n   containers:\n    - name: nginx-ingress-controller\n      image: quay.io/kubernetes-ingress-controller/nginx-ingress\n     args:\n      - /nginx-ingress-controller\n      - --configmap=$(POD_NAMESPACE)/nginx-configuration\n     env:\n      - name: POD_NAME\n        valueFrom:\n         fieldRef:\n          fieldPath: metadata.name\n      - name: POD_NAMESPACE\n        valueFrom:\n         fieldRef:\n          fieldPath: metadata.namespace\n     ports:\n      - name: http\n        containerPort: 80\n      - name: https\n        containerPort: 443\n</code></pre>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#2-create-nodeport-service","title":"2. Create NodePort service","text":"<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n name: nginx-ingress\nspec:\n type: NodePort\n ports:\n - port: 80\n   targetPort: 80\n   protocol: TCP\n   name: http\n - port: 443\n   targetPort: 443\n   protocol: TCP\n   name: https\n  selector:\n   name: nginx-ingress\n</code></pre>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#3-create-a-config-map-referenced-in-deployment","title":"3. Create a config MAP (referenced in Deployment)","text":"<pre><code>kind: ConfigMap\napiVersion: v1\nmetadata:\n name: nginx-configuration\n</code></pre>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#4-create-service-account","title":"4. Create Service Account","text":"<pre><code>apiVersion: v1\nkind: Serviceaccount\nmetadata:\n name: nginx-ingress-serviceaccount\n</code></pre>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#update","title":"Update","text":""},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#deploy-an-ingress-controller","title":"Deploy an Ingress controller","text":"<ul> <li>Nginx</li> <li>HAPROXY</li> <li>Traefik</li> </ul>"},{"location":"CKAD/A7%20Networking%26services/CKAD%20ingress%20Networking/#define-the-ingress-rules-ingress-resources","title":"Define the ingress rules (ingress resources)","text":""},{"location":"CKAD/A7%20Networking%26services/Services/","title":"Services","text":"<p>Services enable connectivity between:</p> <p>Pods, Users and external data sources:</p> <p></p>"},{"location":"CKAD/A7%20Networking%26services/Services/#node-port-service","title":"Node Port Service","text":"<p>Node Port Kubernetes service</p> <p>Ports:</p> <p></p>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Persistent%20Volume/","title":"CKAD Persistent Volume","text":"<p>A persistent Volume is a pool of volumes grouped together to preserve volumes for users.</p>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Persistent%20Volume/#yaml-breakdown","title":"Yaml Breakdown","text":"<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: pv-log\nspec:\n    capacity: \n     storage: 100Mi\n    accessModes: \n     - ReadWriteMany\n    persistentVolumeReclaimPolicy: Retain\n    hostPath: \n     path: /pv/log\n</code></pre>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Persistent%20Volume/#persistentvolumereclaimpolicy","title":"`PersistentVolumeReclaimPolicy:","text":"<p>Defines what happens when a persistent volume claim is deleted:</p> <p><code>Recycle</code>: The data on the persistent Volume is deleted and the volume is available for being claimed again.</p> <p><code>Delete</code>: The volume is automatically deleted after the claim gets deleted</p> <p><code>Retain</code>: The volume cannot be claimed and nothing more happens to it.</p> <p>Access Modes:</p> <p><code>- ReadOnlyMany</code> <code>- ReadWriteOnce</code> <code>- ReadWriteMany</code></p>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Persistent%20Volume/#persistent-volume-claims","title":"Persistent Volume Claims","text":"<p>persistent volumes and persistent volume claims are 2 seperate objects.</p> <p>If all criteria match, kubernetes will bind a persistent volume claim with a persistent volume.</p> <pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n   name: claim-log-1\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 50Mi\n</code></pre>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Persistent%20Volume/#apply-to-pod","title":"Apply to pod:","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  creationTimestamp: \"2023-07-06T11:52:41Z\"\n  name: webapp\n  namespace: default\n  resourceVersion: \"614\"\n  uid: 4c5fcbef-4822-4f86-a095-6ae97a3eaa57\nspec:\n  containers:\n  - env:\n    - name: LOG_HANDLERS\n      value: file\n    image: kodekloud/event-simulator\n    imagePullPolicy: Always\n    name: event-simulator\n    resources: {}\n    terminationMessagePath: /dev/termination-log\n    terminationMessagePolicy: File\n    volumeMounts:\n    - name: logs\n      mountPath: /log\n  volumes:\n    - name: logs\n      persistentVolumeClaim:\n       claimName: claim-log-1\n</code></pre> <p>The same is true for ReplicaSets or Deployments. Add this to the pod template section of a Deployment on ReplicaSet</p>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Stateful%20Sets/","title":"CKAD Stateful Sets","text":"<p>statefulsets are similar to deployments, they however by default have ordered Pod creation (if pod 1 fails creating, pod 2 will never try). This can be changed with  Statefulsets are useful for services with static hostnames.</p>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Stateful%20Sets/#vs-deployments","title":"vs Deployments","text":"Property Deployment Stateful Set Orderd Pod scheduling no (all at once) yes Numbered Pod Name no (random Name) name of statefulset -int usw (yes) <p>Useful for keeping names of e.g a mysql master the same even after recreating the pod. (mysql-0)</p>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Stateful%20Sets/#how-to-create-a-statefulset","title":"How to create a statefulset","text":"<ol> <li>Create deployment</li> <li>change  <code>kind: Deployment</code> to <code>kind: StatefulSet</code></li> <li>Specify <code>serviceName: mysql-h</code> under <code>spec:</code></li> </ol>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Stateful%20Sets/#pod-management-policy","title":"Pod management Policy","text":"<pre><code>spec:\n ...\n podManagementPolicy: Parrallel\n</code></pre>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20Volumes/","title":"CKAD Volumes","text":""},{"location":"CKAD/A8%20state%20persistence/CKAD%20Volumes/#volumes","title":"Volumes","text":"<p>docker volumes</p> <p>Volumes act similar like docker volumes.</p> <p>A directory inside the pod-&gt;Container is mapped to a host directory. When the pod is destroyed the generated data is still in the host directory.</p> <pre><code>volumes:\n- name: data-volume\n  hostPath:\n   path: /data\n   type: Directory\n</code></pre> <p>Multi nodes</p> <p>On a multi node cluster, each node has a different /data directory and have different data on them.  To add volumes that share the same state across nodes use one of the following solutions:</p> <p></p>"},{"location":"CKAD/A8%20state%20persistence/CKAD%20storage%20in%20statefulsets/","title":"CKAD storage in statefulsets","text":"<p>By default when specifing a  in a Stateful Set definitino file all pods will use the same Persistent Volume claim. (all same storage)</p> <p>Solution:</p> <p>Move entire  yml under <code>volumeClaimTemplates:</code></p> <p></p>"},{"location":"CKAD/A8%20state%20persistence/ckad%20Headless%20services/","title":"ckad Headless services","text":""},{"location":"CKAD/A8%20state%20persistence/ckad%20Headless%20services/#example","title":"Example","text":"<p>To make a mysql database accessible to a webserver, a Service is needed. By default this service would loadbalance across all nodes including the slaves. It should only route traffic to the master node by its hostname. For this a ckad Headless service exists.</p> <p></p> <p>Each pod will be accessible by</p> <p><code>podname</code>.<code>headless-service-name</code>.<code>namespace</code>.<code>svc</code>.<code>cluster-domain</code>.<code>top-level-domain</code></p> <pre><code>apiVersion: v1\nkind: Service\nmetadata:\n name: mysql-h\nspec:\n ports:\n  - port: 3306\n selector:\n  app: mysql\n clusterIP: None\n</code></pre> <p>the property <code>cluterIP: None</code> is what differenciates a headless service from a normal service</p>"},{"location":"CKAD/A8%20state%20persistence/ckad%20Headless%20services/#apply-to-pod","title":"apply to pod","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata: \n name: myapp-pod\n labels:\n  app: mysql\nspec:\n containers:\n - name: mysql\n   image: mysql\n subdomain: mysql-h\n hostname: mysql-pod\n</code></pre> <p>Problem</p> <p>All pods will have the same hostname with a template like this in a deployment.</p> <p>(./CKAD Stateful Sets.md)</p> <p>Specify the <code>serviceName:</code> under <code>spec</code> of the statefulset. The statefulset automatically creates a dns record with the pods name. <code>mysql-0...</code></p>"},{"location":"CKAD/A8%20state%20persistence/storage%20classes/","title":"Storage classes","text":"<p>Problem with CKAD Persistent Volumes is, that all the referenced disks (e.g Google cloud disk) need to first be manualy created The Storage Class automatically creates the Persistent Volume but the .</p>"},{"location":"CKAD/A8%20state%20persistence/storage%20classes/#dynamic-provisioning","title":"Dynamic provisioning","text":"<pre><code>apiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n name: google-storage\nprovisioner: kubernetes.io/gce-pd\nparameters:\n type: pd-standart\n replication-type: none\n</code></pre> <p>The optins under <code>parameters</code> are provider specific.</p>"},{"location":"CKAD/A9%20Updates%2020201/CKAD%20Authentication%2C%20Authorization%20and%20Admission%20Control/","title":"CKAD Authentication, Authorization and Admission Control","text":""},{"location":"CKAD/A9%20Updates%2020201/CKAD%20Authentication%2C%20Authorization%20and%20Admission%20Control/#hosts","title":"Hosts","text":"<ul> <li>[ ] Root disabled</li> <li>[ ] Password based authentication disabled</li> <li>[ ] SSH Key based authentication</li> </ul> <p>CKAD Authentication</p> <p>CKAD Authorization</p> <p>CKAD RBAC</p> <p>CKAD Adission control</p>"},{"location":"CKAD/Tips/Extract%20yaml%20of%20pod/","title":"Extract yaml of pod","text":"<p><code>kubectl get pod webapp -o yaml &gt; my-new-pod.yaml</code></p>"},{"location":"CKAD/Tips/Formatting%20output%20kubectl/","title":"Formatting output kubectl","text":"<ul> <li><code>-o json</code> output a JSON formatted object</li> <li><code>-o name</code> print only the resource name and nothing else</li> <li><code>-o wide</code> output in the plain text format with any additional information</li> <li><code>-o yaml</code> output yaml formatted API object Create yaml example: <pre><code>$ kubectl get create namespace test --dry-run -o yaml\n</code></pre> Wide <pre><code>kubectl get pods -o wide\n- NAME\u00a0 \u00a0 \u00a0 READY\u00a0 \u00a0STATUS\u00a0 \u00a0 RESTARTS\u00a0 \u00a0AGE\u00a0 \u00a0 \u00a0IP\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 NODE\u00a0 \u00a0 \u00a0NOMINATED NODE\u00a0 \u00a0READINESS GATES\n- busybox\u00a0 \u00a01/1\u00a0 \u00a0 \u00a0Running\u00a0 \u00a00\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 3m39s\u00a0 \u00a010.36.0.2\u00a0 \u00a0node01\u00a0 \u00a0&lt;none&gt;\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0&lt;none&gt;\n- ningx\u00a0 \u00a0 \u00a01/1\u00a0 \u00a0 \u00a0Running\u00a0 \u00a00\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 7m32s\u00a0 \u00a010.44.0.1\u00a0 \u00a0node03\u00a0 \u00a0&lt;none&gt;\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0&lt;none&gt;\n- redis\u00a0 \u00a0 \u00a01/1\u00a0 \u00a0 \u00a0Running\u00a0 \u00a00\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 3m59s\u00a0 \u00a010.36.0.1\u00a0 \u00a0node01\u00a0 \u00a0&lt;none&gt;\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0&lt;none&gt;\n</code></pre></li> </ul>"},{"location":"CKAD/Tips/Imperative%20Commands/","title":"Imperative Commands","text":""},{"location":"CKAD/Tips/Imperative%20Commands/#exam","title":"exam","text":"<p>Time management</p> <p>During exams you have to create stuff with yaml files. There however is not enought time to write them all from scratch. Use dry run commands to create yaml files and edit them.</p>"},{"location":"CKAD/Tips/Imperative%20Commands/#theory","title":"Theory","text":"<p>imperative commands  are useful for quickly creating a ressource e.g <code>kubectl run nginx-pod --image=nginx:alpine</code> Dry run=client To test if any command will work without creating all ressources use the <code>--dry-run=client</code> flag. -o yaml This will output the resource definition in yaml format on the screen.</p> <p>Create template: <code>kubectl run nginx --image=nginx --dry-run=client -o yaml &gt; nginx-pod.yaml</code></p>"},{"location":"CKAD/Tips/Imperative%20Commands/#examples","title":"Examples","text":"<p>deployment with 4 replicas: <code>kubectl create deployment nginx --image=nginx --replicas=4</code> Create a Service named redis-service of type ClusterIP to expose pod redis on port 6379 (assumes the label <code>app=redis</code> has been set) <code>kubectl expose pod redis --port=6379 --name redis-service --dry-run=client -o yaml</code> $</p>"},{"location":"CKAD/Tips/Imperative%20Commands/#namespace-in-current-session","title":"Namespace in current session:","text":"<p><code>kubectl config set-context --current --namespace=elastic-stack</code></p>"},{"location":"CKAD/Tips/Useful%20Links/","title":"Useful Links","text":"<p>Some1s OSome1s OP Preparation notesP Preparation notes</p> <p>Useful blog</p> <p>CKAD Exercises</p> <p>K8S for beginners Course</p> <p>CKAD Udemy Course</p> <p>Docker Udemy Course</p>"},{"location":"CKAD/Tips/speed%20delete/","title":"Speed delete","text":"<p><code>k delete name --force</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/a23%20howto/","title":"A23 howto","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/a23%20howto/#lege-fur-jeden-deiner-container-einen-service-an","title":"Lege f\u00fcr jeden deiner Container einen Service an","text":"<p>Some already have services</p> <p>The redis master and the redis follower pod already have services</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/a23%20howto/#1x-mal-fur-das-frontend","title":"1x mal f\u00fcr das Frontend","text":"<p><code>kubectl create service  nodeport frontend --tcp 8080:8080 -o yaml &gt; frontend-np.yml</code></p> <p>frontend-np</p> <p>Access by <code>172.18.0.2:30233</code> (Ip of a node)</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/a23%20howto/#1x-fur-redis","title":"1x f\u00fcr Redis.","text":"<p>Exists.</p> <p>Info</p> <p>F\u00fcr das Frontend soll der type \"NodePort\" sein</p> <p>Erreich das Frontend via NodePort</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a1%20Pods%20and%20edit/A1%20PP%20edit%20pods/","title":"A1 PP edit pods","text":"<ol> <li>Build pod <code>docker build -t phonkd/t-practice:v1 .</code></li> <li>Push <code>docker push phonkd/t-practice:v1</code></li> </ol>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a1%20Pods%20and%20edit/A1%20PP%20edit%20pods/#run","title":"Run","text":"<p><code>kubectl run --image phonkd/t-practice:2 a1a1</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a1%20Pods%20and%20edit/A1%20PP%20edit%20pods/#port-forward","title":"Port Forward","text":"<p>Priveleged ports</p> <p>In Linux ports smaller than <code>1023</code> are considered priveleged. Use ports higher than that to avoid permission denied.</p> <p><code>kubectl port-forward a1a1 5069:80</code></p> <p>Access page on <code>localhost:5069</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a1%20Pods%20and%20edit/A1%20PP%20edit%20pods/#port-andern","title":"Port \u00e4ndern?","text":"<p>Port existiert bei <code>kubectl edit pod a1a1</code> nicht.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a1%20Pods%20and%20edit/A1%20PP%20edit%20pods/#name-andern","title":"Name \u00e4ndern","text":"<p>Nicht m\u00f6glich, metadata kann nicht angepasst werden</p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a1%20Pods%20and%20edit/A1%20PP%20edit%20pods/#yaml-von-laufendem-pod-exportieren","title":"Yaml von laufendem pod exportieren","text":"<p><code>kubectl get pod a1a1 -o yaml &gt; a1-exported-pod.yml</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a1%20Pods%20and%20edit/A1%20PP%20edit%20pods/#andere-port-im-yml-no-port","title":"\u00c4ndere port im yml ???? no port","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a1%20Pods%20and%20edit/A1%20PP%20edit%20pods/#bonus","title":"Bonus:","text":"<p>yaml</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a10%20CKAD%20Security%20Contexts/a10%20CKAD%20Security%20context/","title":"a10 CKAD Security context","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a10%20CKAD%20Security%20Contexts/a10%20CKAD%20Security%20context/#sichere-deinen-container-ab-dass-sie-nicht-als-root-user-laufen-und-man-auch-nicht-nachtraglich-root-werden-kann","title":"Sichere deinen Container ab, dass sie nicht als Root user laufen und man auch nicht nachtr\u00e4glich Root werden kann.","text":"<p>I've edited the dockerfile to add a new user with the userid 1500 and added <code>securityContext:</code> <code>runAsUser: 1500</code> to my deployment yaml file.</p> <p>ckad-security-context-dockerfile</p> <p>a10 CKAD Sec context-frontend</p> <p>Result</p> <p></p> <p>Containers seem to crash</p> <p></p> <p>Cause seems to be a Permission denied error (no longer root).</p> <p>Problem is that the gb-frontend google image wants to listen on port 80 which is a priveleged port. Therefore root access is required. A possible solution would be to edit the config files of apache via a config map. By changing to a port higher than 1000 it could work without root accesss.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a10%20CKAD%20Security%20Contexts/a10%20CKAD%20Security%20context/#verhindere-dass-in-deinen-container-system-capabilities-verwendet-werden-konnen","title":"Verhindere, dass in deinen Container System Capabilities verwendet werden k\u00f6nnen:","text":"<p>Im a10 CKAD Sec context-frontend file wurde unter <code>securityContext:</code> das felt <code>capabilities:</code> <code>drop:</code> hinzufgef\u00fcgt und <code>- All</code> wurde ausgew\u00e4hlt. Daraufhin crasht der Pod weil er keine rechte hat:</p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a11%20PP%20CKAD%20Service%20Accounts/a11%20PP%20CKAD%20Service%20Accounts/","title":"a11 PP CKAD Service Accounts","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a11%20PP%20CKAD%20Service%20Accounts/a11%20PP%20CKAD%20Service%20Accounts/#widr-ine-cho","title":"Widr ine cho","text":"<pre><code>pacman -S docker go kubectl\ngo install sigs.k8s.io/kind@v0.20.0\nsudo systemctl enable --now docker\nreboot\nkubectl create namespace namespace-frontend-1\nkuebctl create namespace namespace-redis-2\n</code></pre> <p><code>kubectl create -fn namespace-frontent-1</code>a11-frontend.yml <code>kubectl create -fn namespace-frontend-1</code>a11-configmap-frontend.yml</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a11%20PP%20CKAD%20Service%20Accounts/a11%20PP%20CKAD%20Service%20Accounts/#erstelle-einen-service-account-fur-dein-frontend-und-einen-zweiten-fur-redis","title":"Erstelle einen Service Account f\u00fcr dein Frontend und einen zweiten f\u00fcr Redis.","text":"<p>Stelle sicher, dass deine Deployments die Service Accounts verwenden.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a11%20PP%20CKAD%20Service%20Accounts/a11%20PP%20CKAD%20Service%20Accounts/#create-secrets","title":"Create secrets","text":"<p><code>kubectl create -n namespace-frontend-1 serviceaccount frontend-svcacc --dry-run=client -o yaml &gt; service-account-frontend.yml</code></p> <p><code>kubectl apply -f</code> service-account-frontend.yml</p> <p><code>kubectl create -n namespace-redis-2 serviceaccount redis-svcacc --dry-run=client -o yaml &gt; service-account-redis.yml</code></p> <p><code>kubectl apply -f</code> service-account-redis.yml</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a11%20PP%20CKAD%20Service%20Accounts/a11%20PP%20CKAD%20Service%20Accounts/#find-secrets","title":"find secrets","text":"<pre><code>kubectl describe -n namespace-frontend-1 serviceaccount frontend-svcacc\n</code></pre> <p>Token (secrets) are no longer automatically generated since 1.24</p> <p>Does our deployment even need a secret token (?)</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a11%20PP%20CKAD%20Service%20Accounts/a11%20PP%20CKAD%20Service%20Accounts/#add-the-service-account-to-the-deployment","title":"Add the service account to the deployment:","text":"<p>a11-frontend</p> <p>a11-ckad-namespaces-redis</p> <p>a11-ckad-namespaces-redis-follower</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a11%20PP%20CKAD%20Service%20Accounts/a11%20PP%20CKAD%20Service%20Accounts/#make-sure-the-serviceaccounts-are-being-used","title":"Make sure the serviceaccounts are being used:","text":"<pre><code>kubectl describe pod --all-namespaces | grep -A 10 -B 10 \"Service Account\"\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a12%20Resource%20requirements/a12%20CKAD%20PP%20Resource%20Req/","title":"a12 CKAD PP Resource Req","text":"<p>ckad-resource-requirements</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a12%20Resource%20requirements/a12%20CKAD%20PP%20Resource%20Req/#stell-sicher-dass-deine-pods-mindestens-einen-viertel-cpu-core-und-500mb-memory-zur-verfugung-haben-aber-nicht-mehr-als-einen-halben-cpu-core-und-1gb-memory","title":"Stell sicher, dass deine Pods mindestens einen viertel CPU-Core und 500MB Memory zur verf\u00fcgung haben aber nicht mehr als einen halben CPU-Core und 1GB Memory","text":"<p>Instead of defining the limits in all yaml files i decided to create a limit range.</p> <p>a12-limit-range</p> <p><code>kubectl create -f a12-limit-range.yml -n namespace-...</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a12%20Resource%20requirements/a12%20CKAD%20PP%20Resource%20Req/#such-dir-einen-befehl-mit-welchem-du-eine-grosse-cpu-oder-ram-auslastung-erzwingen-kannst-siehe-zb-httpsunixstackexchangecomquestions99334how-to-fill-90-of-the-free-memory254976254976","title":"Such dir einen Befehl, mit welchem du eine grosse CPU oder RAM Auslastung erzwingen kannst. (Siehe z.B https://unix.stackexchange.com/questions/99334/how-to-fill-90-of-the-free-memory/254976#254976).","text":"<pre><code>echo {1..1000000000}\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a12%20Resource%20requirements/a12%20CKAD%20PP%20Resource%20Req/#versuche-zu-erzwingen-dass-dein-pod-restarted-wird-aufgrund-zu-hoher-auslastung","title":"Versuche zu erzwingen, dass dein Pod restarted wird, aufgrund zu hoher Auslastung.","text":"<p>Danger</p> <p>I ran the command  <code>echo {1..1000000000}</code> Inside of the container of deployment-frontend-1 and after 20 seconds my host os completely froze. CTRL alt fkey didnt work and i had to force reboot.</p> <p>Solution</p> <p>The issue was me not specifying the namespace in the limit range definition file. I had to then resetup the cluster. And of course add the correct namespace </p> <pre><code>kind create cluster --config kind-config.yml --name phonkds-cluster\nkubectl create namespace namespace-frontend-1\nkubectl create namespace namespace-redis-2\nkubectl create -f a12-limit-range.yml\nkubectl create -f a12-frontend.yml\nkubectl create -f a12-configmap-frontend.yml\nkubectl create -f ../a11\\ PP\\ CKAD\\ Service\\ Accounts/service-account-frontend.yml\nkubectl create -f ../a11\\ PP\\ CKAD\\ Service\\ Accounts/service-account-redis.yml\n</code></pre> <p>Success</p> <p>Now running echo {1..10000000000} Terminates the container with code 137. (Exit code 137 means a container or pod is trying to use more memory than allowed.)   It however immediatly gets recreated.</p> <p>^70a05d</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a12%20Resource%20requirements/a12%20CKAD%20PP%20Resource%20Req/#schau-dir-im-anschluss-pod-genauer-an-was-fallt-dir-auf-zb-der-status-oder-auch-containersstate","title":"Schau dir im Anschluss Pod genauer an. Was f\u00e4llt dir auf (z.b der Status oder auch Containers.state)","text":"<p>Here</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a12%20Resource%20requirements/a12%20CKAD%20PP%20Resource%20Req/#uberlege-dir-wie-du-bei-einer-neuen-applikation-entscheiden-wurdest-wie-die-resourcen-konfiguration-aussieht","title":"\u00dcberlege dir wie du bei einer neuen Applikation entscheiden w\u00fcrdest wie die Resourcen Konfiguration aussieht","text":"<p>In practice for a new application i would not use limits but only use requests. Since with requests all pods get their requested amount of resources, but still can exceed it as long as no other requests are affected.</p> <p>Here</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a13%20CKAD%20Labels%20and%20annotations/a13%20CKAD%20PP%20Labels%20and%20annotations/","title":"a13 CKAD PP Labels and annotations","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a13%20CKAD%20Labels%20and%20annotations/a13%20CKAD%20PP%20Labels%20and%20annotations/#beschreibe-in-deinen-eigenen-worten-wie-sich-labels-und-annotations-in-ihrem-verwendungszweck-unterscheiden","title":"Beschreibe in deinen eigenen Worten wie sich Labels und Annotations in ihrem Verwendungszweck unterscheiden.","text":"<p>Answer</p> <p>Labels are used to identify objects inside of a cluster.  An example of that are labeled pods. With those labels replicasets know if a pod can be counted in or not. On the other hand annotations are notes/explanations that can be added to pods. An example anotation would be <code>buildVersion: 1.2.1</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a13%20CKAD%20Labels%20and%20annotations/a13%20CKAD%20PP%20Labels%20and%20annotations/#vergib-fur-deine-frontend-und-backend-sinnvolle-labels","title":"Vergib f\u00fcr deine Frontend und Backend sinnvolle Labels:","text":"Key Frontend Redis master Redis follower <code>gb-component:</code> <code>frontend</code> <code>redis</code> <code>redis-follower</code>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a13%20CKAD%20Labels%20and%20annotations/a13%20CKAD%20PP%20Labels%20and%20annotations/#frontend","title":"Frontend:","text":"<p>See: a12-frontend</p> <p><code>k apply -f a12-frontend.yml</code></p> <p><code>kubectl get pods --all-namespaces --label-columns gb-component</code></p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a13%20CKAD%20Labels%20and%20annotations/a13%20CKAD%20PP%20Labels%20and%20annotations/#redis","title":"Redis","text":"<p>See: a12-ckad-redis a12-ckad-redis-follower</p> <p><code>k apply -f a12-redis.yml</code> &amp; <code>k apply -f a12-redis-follower.yml</code></p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a14%20CKAD%20Taints%20and%20tolerations/a14%20CKAD%20PP%20Taints%20and%20tolerations%20%26mor/","title":"a14 CKAD PP Taints and tolerations &mor","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a14%20CKAD%20Taints%20and%20tolerations/a14%20CKAD%20PP%20Taints%20and%20tolerations%20%26mor/#deploy-das-frontend-so-dass-auf-allen-nodes-mindestens-ein-pod-lauft-control-plane-und-worker","title":"Deploy das Frontend so, dass auf allen Nodes mindestens ein Pod l\u00e4uft ( Control-plane und Worker)","text":"<p>Answer</p> <p>Since we have 3 nodes we need at least 3 nodes to evenly distribute pods across all nodes. <code>kubectl scale --replicas 3 -n namespace-frontend-1 deployment-name</code></p> <p>We also need to remove the taint from the control plane node so that pods can be placed on it: <code>kubectl taint node phonkds-cluster-control-plane node-role.kubernetes.io/control-plane:NoSchedule-</code></p> <p>Then recreate the deployment <code>k delete -f a14-deployment.yml</code> <code>k create -f a14-deployment.yml</code> </p> <p>Then </p> <p>Bonus:</p> <p>Egal wie du das Problem oben gel\u00f6st hast, es gibt mindestens noch einen zweiten Weg. Finde heraus welchen und beschreibe die Unterschiede.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a15%20CKAD%20PP%20Multi%20container%20pods/a15%20CKAD%20PP%20Multi%20container%20pods%20howto/","title":"a15 CKAD PP Multi container pods howto","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a15%20CKAD%20PP%20Multi%20container%20pods/a15%20CKAD%20PP%20Multi%20container%20pods%20howto/#fuge-deinem-redis-master-pod-einen-zweiten-container-hinzu-welcher-regelmassig-einen-redis-dump-durchfuhrt","title":"F\u00fcge deinem Redis Master Pod einen zweiten Container hinzu, welcher regelm\u00e4ssig einen Redis dump durchf\u00fchrt.","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a15%20CKAD%20PP%20Multi%20container%20pods/a15%20CKAD%20PP%20Multi%20container%20pods%20howto/#troubleshooting","title":"Troubleshooting","text":"<p>Error Error Error Error</p> <p>Before realizing that the redis-follower also needs a ClusterIP service i wasted my time doing the following: - Moved all pods into one namespace - quadruple checked every name, label and selector - Checked if the redis hostname can be resolved using <code>nslookup redis</code> from gb-frontend (with success) - Tried other Browser (firefox &amp; Chrome) a15-redis-avail a15-ckad-namespaces-redis a15-ckad-namespaces-frontend a15-ckad-namespaces-redis-follower</p> <p>Second try</p> <p>I have gone back to the docker exercieses where the same goal was already achieved using docker compose: a7-docker-compose</p> <p>After testing it again i found that removing the redis-follower from the redis network results in this error:  Meaning that potentially the redis-follower is the issue. So i also created a service for the redis-follower: <code>kubectl create service clusterip --tcp 6379:6379 redis-follower -n namespace-frontend-1 -o yaml &gt; a15-redis-flw-cip.yml</code> And it worked!!! (only on chromium not on firefox) </p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a15%20CKAD%20PP%20Multi%20container%20pods/a15%20CKAD%20PP%20Multi%20container%20pods%20howto/#real","title":"Real","text":"<p>Again i look at how i did this  in docker a6-docker-compose. Most likely because the path to here contains spaces, kubernetes cant find the directory. After adding \"\" it still does not work and i decided to symlink the directory to /home/phonkd/redis-persistence. <code>ln -s redis-dumps /home/phonkd/redis-persistence</code> This did also not work so i just directly created the dump folder in <code>/home/phonkd</code>.</p> <p>Bruh</p> <p>The directory needs to exist inside of the docker container (node)</p> <p> Container fails after bein recreated because the directory does not exist on all nodes BRUUUH ```bash docker exec -it 0ec mkdir -p /home/phonkd/redis-dumps docker exec -it 238 mkdir -p /home/phonkd/redis-dumps</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a15%20CKAD%20PP%20Multi%20container%20pods/a15%20CKAD%20PP%20Multi%20container%20pods%20howto/#regularily-snapshot","title":"Regularily snapshot:","text":"<p>For this i created a a15-redis for containing the redis config file. (<code>save 60 0</code>)</p> <p>I mapped it into the redis-leader deployment and added <code>redis-server</code> with the <code>args</code> <code>/usr/local/redis.conf</code> (config file location). Now it creates a snapshot every minute as long as 0 character changes.</p> <p></p> <p>Bruh dat kein zweita container.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a15%20CKAD%20PP%20Multi%20container%20pods/a15%20CKAD%20PP%20Multi%20container%20pods%20howto/#container-nr-2","title":"Container nr 2","text":"<p>I added another container with the name <code>redis-dumper</code>. On running it the command <code>redis-cli</code> with the arguments <code>-h redis-master -a 123 -r -1 -i 1 save</code> . - <code>-r</code> is the amount of times <code>-1</code> means indefinitely - <code>-i</code> is the interval <code>1</code> means every second - <code>save</code> creates the dump</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a16%20CKAD%20PP%20Init%20container/a16%20CKAD%20init%20containers/","title":"a16 CKAD init containers","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a16%20CKAD%20PP%20Init%20container/a16%20CKAD%20init%20containers/#fuge-deinem-frontend-deployment-einen-init-container-hinzu-der-sicherstellt-dass-redis-erreichbar-ist","title":"F\u00fcge deinem Frontend Deployment einen Init-Container hinzu der sicherstellt, dass Redis erreichbar ist.","text":"<p>See: a16-frontend</p> <p>The init container would fail and in the logs i could find <code>auth required</code>.</p> <p>After changing the configmap and removing the <code>requirepass</code> field i only had to delete the redis pods and then the gb-frontend would start.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a17%20CKAD%20PP%20Readiness%20Startup%20and%20Liveness%20Probes/a17%20CKAD%20Readiness%20Startup%20and%20Liveness%20Probes/","title":"a17 CKAD Readiness Startup and Liveness Probes","text":"<p>F\u00fcge deinem Frontend Deployment sinnvolle Liveness, Readiness und Startup Probes hinzu ( Probe kann auch mehrmals das gleiche Pr\u00fcfen)  Teste deine Liveness Probe.</p> <p>a17-frontend</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a17%20CKAD%20PP%20Readiness%20Startup%20and%20Liveness%20Probes/a17%20CKAD%20Readiness%20Startup%20and%20Liveness%20Probes/#test","title":"Test","text":"<p>To test the probes i connected to the gb-frontend pod and deleted all files in the <code>/var/www/html</code> directory making the website show Forbidden. </p> <p>After about 15 seconds the pod was automatically recerated.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a18%20CKAD%20Container%20Logging/a18%20CKAD%20Container%20logging/","title":"a18 CKAD Container logging","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a18%20CKAD%20Container%20Logging/a18%20CKAD%20Container%20logging/#zeige-die-logs-von-einem-frontend-pod-an","title":"Zeige die Logs von einem Frontend Pod an:","text":"<pre><code>kubectl logs pods/gb-frontend...\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a18%20CKAD%20Container%20Logging/a18%20CKAD%20Container%20logging/#zeige-die-logs-von-deinem-init-container-an","title":"Zeige die Logs von deinem Init-Container an:","text":"<pre><code>kubectl logs pods/gb-frontend-6cbfbbdb8c-dr8bw redis-follower-availability-tester\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a18%20CKAD%20Container%20Logging/a18%20CKAD%20Container%20logging/#zeige-die-logs-von-allen-frontend-pods-gleichzeittig-mit-nur-einem-command-an","title":"Zeige die Logs von allen Frontend Pods gleichzeittig mit nur einem Command an:","text":"<pre><code>kubectl logs -l app=frontend\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a19%20CKAD%20Monitoring%20and%20debugging/a19%20CKAD%20Monitoring%20and%20debugging/","title":"a19 CKAD Monitoring and debugging","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a19%20CKAD%20Monitoring%20and%20debugging/a19%20CKAD%20Monitoring%20and%20debugging/#davon-ausgehend-dass-dein-liveness-probe-test-funktioniert-hat-sollte-mindestens-einer-deiner-pods-einen-restart-habenwie-wurdest-du-vorgehen-um-herauszufinden-warum-der-pod-restarted-hat","title":"Davon ausgehend, dass dein Liveness Probe Test funktioniert hat, sollte mindestens einer deiner Pods einen Restart haben.Wie w\u00fcrdest du vorgehen um herauszufinden warum der Pod restarted hat?","text":"<pre><code>kubectl describe pod poddd\nkubectl logs pod pods/pod/\nkubectl describe deployment deployment-name\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a19%20CKAD%20Monitoring%20and%20debugging/a19%20CKAD%20Monitoring%20and%20debugging/#davon-ausgehend-dass-du-einen-ingress-hast-welcher-auf-dein-frontend-zeigt-wie-wurdest-du-debuggen-wenn-deine-website-nicht-erreichbar-ist","title":"Davon ausgehend, dass du einen Ingress hast welcher auf dein Frontend zeigt. Wie w\u00fcrdest du debuggen wenn deine Website nicht erreichbar ist","text":"<pre><code>k describe ingress ingress-name (auf endpoints schauen)\nk describe ingress ingress-name (auf endpoints schauen)\n</code></pre> <p>Success</p> <p>If the endpoints aren't working check the selector of the service or the ingress.</p> <p>-a \"123\" -h redis-master</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/","title":"a2 CKAD ReplicaSets Howto","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/#refreshd","title":"Refreshd","text":"<p>Replicasets vs deployments</p> <p>Replicasets are a lower object, automatically created by deployments. Replicasets create the pods. Replicasets can be seperatly created.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/#packe-deinen-pod-in-ein-replicaset-und-stell-sicher-dass-3-pods-laufen","title":"Packe deinen Pod in ein ReplicaSet und stell sicher, dass 3 Pods laufen.","text":"<p>Siehe</p> <p>Obsidian: a2-replica-set</p> <p>Others: <code>./a2-replica-set-yml</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/#vergleiche-die-drei-pods-deines-replicasets-mit-dem-pod-aus-der-vorherigen-ubung-kubectl-describe-ist-dein-freund-was-fallt-dir-dabei-auf","title":"Vergleiche die drei Pods deines Replicasets mit dem Pod aus der vorherigen \u00dcbung (<code>kubectl describe</code> ist dein freund). Was f\u00e4llt dir dabei auf?","text":"<p>Der namen der Pods besteht aus <code>replicasetName</code>-<code>random</code></p> <p>Die pods sind alle genau gleich alt: </p> <p></p> <p>sonst sind alle pods fast gleich</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/#skaliere-die-pods-auf-4-welche-moglichkeiten-kennst-du-dafur","title":"Skaliere die Pods auf 4. Welche m\u00f6glichkeiten kennst du daf\u00fcr?","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/#command","title":"Command:","text":"<p><code>kubectl scale replicaset --replicas 4 a2-replicaset</code> (passt auch das yaml an)</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/#yaml-edit","title":"Yaml Edit","text":"<p><code>kubectl edit replicaset a2-replicaset</code></p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/#losche-einen-pod-was-passiert","title":"L\u00f6sche einen Pod. Was passiert?","text":"<p>Der pod wird gel\u00f6scht, aber direkt wird ein neuer gestartet:</p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a2%20ReplicaSets/a2%20CKAD%20ReplicaSets%20Howto/#fug-den-durch-das-replicaset-ausgerollten-pods-ein-neues-label-hinzu-es-darf-maximal-ein-command-verwendet-werden-was-passiert-evtl-musst-du-kurz-warten","title":"F\u00fcg den, durch das Replicaset, ausgerollten Pods ein neues Label hinzu. Es darf maximal ein Command verwendet werden. Was passiert (evtl. Musst du kurz warten)?","text":"<p><code>kubectl label pod name huan=1</code></p> <p>Das label wird dem Pod hinzugef\u00fcgt und kann mit <code>kubectl describe pod podname</code> eingesehen werden.</p> <p>Auch nach langem warten (15 min) passiert mit dem Pod nichts.</p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/","title":"a20 Rolling updates and rollbacks pp howto","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/#erstelle-eine-neue-version-deines-frontend-images-ie-neuer-tag","title":"Erstelle eine neue Version deines Frontend Images (ie. neuer Tag):","text":"<p>a20-dockerfile</p> <pre><code>docker build .\ndocker login\ndocker tag phonkd/t-practice:v6\ndocker push phonkd/t-practice:v6\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/#stelle-sicher-das-vom-alten-frontend-3-replicas-laufen","title":"Stelle sicher, das vom \"alten\" Frontend 3 Replicas laufen","text":"<p>a20-frontend </p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/#aktualisiere-den-tag-im-deployment","title":"Aktualisiere den Tag im Deployment","text":"<p>a20-frontend </p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/#4-beobachte-wie-das-neue-image-ausgerollt-wird","title":"4. Beobachte wie das neue Image ausgerollt wird","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/#5-mache-ein-helm-rollback-auf-die-letzte-revision","title":"5. mache ein ~~helm~~ rollback auf die letzte Revision","text":"<pre><code>yay -S helm\n</code></pre> <pre><code>kubectl rollout undo deployments/gb-frontend\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/#welche-arten-von-updates-gibt-es-worin-unterscheiden-sie-sich","title":"Welche Arten von Updates gibt es? Worin unterscheiden Sie sich?","text":"<p>There are two types of updates:</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/#rolling","title":"Rolling:","text":"<p>This is the default update strategy. When using this strategy, one by one pods are deleted and recreated with the new version. Bonus: + 0 Downtime (Old pod only gets replaced if new one is ready) + Possibility to specify the maximum amount or percentage of pods being recreated at times - Compared to recreate takes longer until new version is fully applied</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a20%20CKAD%20PP%20Rolling%20Updates%26Rollbacks/a20%20Rolling%20updates%20and%20rollbacks%20pp%20howto/#recreate","title":"Recreate:","text":"<p>With this strategy, all pods are deleted at once and recreated. Bonus + Deploying new version is faster -/+ Pods get deleted before new pod is ready</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a21%20CKAD%20PP%20Jobs/a21%20CKAD%20PP%20Jobs/","title":"a21 CKAD PP Jobs","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a21%20CKAD%20PP%20Jobs/a21%20CKAD%20PP%20Jobs/#erstelle-einen-job-der-die-grosse-der-redis-datenbank-im-log-ausgiebt","title":"Erstelle einen Job der die gr\u00f6sse der Redis datenbank im log ausgiebt:","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a21%20CKAD%20PP%20Jobs/a21%20CKAD%20PP%20Jobs/#find-out-how-to-get-size","title":"Find out how to get size:","text":"<p>Using dbsize</p> <p><code>kubectl exec -it redis-master... -- bash</code></p> <pre><code>redis-cli -r 100 -i 1  DBSIZE\n</code></pre> <p>Seems to not work or db is always 0</p> <p> Even with entries: </p> <p>Check memory usage (since redis is in memory):</p> <pre><code>redis-cli -h redis-master info memory | grep used_memory:\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a21%20CKAD%20PP%20Jobs/a21%20CKAD%20PP%20Jobs/#creating-the-jobs","title":"Creating the jobs:","text":"<p>i now created 2 jobs, one using the feature to get the current size of redis db with the <code>DBSIZE</code> and one with the memory size <code>memsize</code>.</p> <p>memsize-job dbsize-job</p> <pre><code>kubectl logs memsize dbsize\nkubectl logs memsize memsize\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a22%20CKAD%20PP%20Cron%20Jobs/a22%20CKAD%20PP%20Cron%20Jobs/","title":"a22 CKAD PP Cron Jobs","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a22%20CKAD%20PP%20Cron%20Jobs/a22%20CKAD%20PP%20Cron%20Jobs/#verpacke-den-erstellten-job-in-einen-cronjob-der-alle-5-minuten-lauft","title":"Verpacke den erstellten job in einen cronjob der alle 5 minuten l\u00e4uft:","text":"<p>Job: memsize-job Cronjob: cron</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a22%20CKAD%20PP%20Cron%20Jobs/a22%20CKAD%20PP%20Cron%20Jobs/#starte-einen-run-deines-cronjobs-ausserhalb-des-intervals","title":"Starte einen Run deines Cronjobs ausserhalb des intervals:","text":"<pre><code>kubectl create job --from=rediscron manual-run\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a3%20Deployments/CKAD%20Deployment%20howto/","title":"CKAD Deployment howto","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a3%20Deployments/CKAD%20Deployment%20howto/#packe-deinen-pod-in-ein-replicaset-und-stell-sicher-dass-3-pods-laufen","title":"Packe deinen Pod in ein replicaSet und stell sicher dass 3 pods laufen","text":"<p><code>./a2-deploy-replic.yml</code></p> <p>a2-deploy-replic Obsidian users</p> <p><code>replicas: 1</code> --&gt; <code>replicas: 3</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a3%20Deployments/CKAD%20Deployment%20howto/#vergleiche-die-drei-pods-deines-replicasets-mit-dem-pod-aus-der-vorherigen-ubung-kubectl-describe-ist-dein-freund-was-fallt-dir-dabei-auf","title":"Vergleiche die drei Pods deines Replicasets mit dem Pod aus der vorherigen \u00dcbung (<code>kubectl describe</code> ist dein freund). Was f\u00e4llt dir dabei auf?","text":"<p>Es ist zu sehen welches replicaset die pods erstellt hat besteht aus <code>deploymentName</code>-<code>replicaset-id(am ende vom namen)</code>-<code>5stellige id</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a3%20Deployments/CKAD%20Deployment%20howto/#skaliere-die-pods-auf-4-welche-moglichkeiten-kennst-du-dafur","title":"Skaliere die Pods auf 4. Welche m\u00f6glichkeiten kennst du daf\u00fcr?","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a3%20Deployments/CKAD%20Deployment%20howto/#via-command","title":"via command:","text":"<p><code>kubectl scale deployment --replicas 4 deployment-of-exported-785ccc6d8d</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a3%20Deployments/CKAD%20Deployment%20howto/#losche-einen-pod-was-passiert","title":"L\u00f6sche einen Pod. Was passiert?","text":"<p>Er wird gel\u00f6scht aber direkt neu erstellt</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a3%20Deployments/CKAD%20Deployment%20howto/#fug-dem-deployment-pod-ein-neues-label-hinzu-es-darf-maximal-ein-command-verwendet-werden-was-passiert-evtl-musst-du-kurz-warten","title":"F\u00fcg dem deployment pod ein neues Label hinzu. Es darf maximal ein Command verwendet werden. Was passiert (evtl. Musst du kurz warten)?","text":"<p><code>kubectl label pod deployment-of-exported-785ccc6d8d-dmgnv huan=1</code></p> <p>nichts passiert, es gibt keinen unterschied zum replicaset (nirgends passiert was)</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a4%20CKAD%20formatting%20output%20with%20kubectl/a4%20CKAD%20Formatting%20output%20with%20kubectl/","title":"a4 CKAD Formatting output with kubectl","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a4%20CKAD%20formatting%20output%20with%20kubectl/a4%20CKAD%20Formatting%20output%20with%20kubectl/#zeig-alle-pods-an-es-soll-zusatzlich-die-pod-ip-und-der-node-auf-welchem-der-pod-lauft-sichtbar-sein","title":"Zeig alle Pods an; Es soll zus\u00e4tzlich die Pod IP und der Node auf welchem der pod l\u00e4uft sichtbar sein:","text":"<p><code>kubectl get pods -o wide</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a4%20CKAD%20formatting%20output%20with%20kubectl/a4%20CKAD%20Formatting%20output%20with%20kubectl/#zeig-die-definition-deines-deployments-als-im-yaml-format-an","title":"Zeig die definition deines Deployments als im yaml format an.","text":"<p><code>kubectl get deployments.apps -o yaml deployment-of-exported</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a4%20CKAD%20formatting%20output%20with%20kubectl/a4%20CKAD%20Formatting%20output%20with%20kubectl/#zeig-die-definition-deines-deployments-als-im-json-format-an","title":"Zeig die definition deines Deployments als im json format an.","text":"<p><code>kubectl get deployments.apps -o json deployment-of-exported</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a4%20CKAD%20formatting%20output%20with%20kubectl/a4%20CKAD%20Formatting%20output%20with%20kubectl/#zeige-nur-den-namen-aller-pods-an","title":"Zeige nur den Namen aller Pods an","text":"<p><code>kubectl get pods -o name</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a4%20CKAD%20formatting%20output%20with%20kubectl/a4%20CKAD%20Formatting%20output%20with%20kubectl/#zeige-den-namen-und-das-image-aller-pods-an-es-soll-eine-spalte-podname-und-eine-image-geben","title":"Zeige den Namen und das Image aller Pods an Es soll eine Spalte PODNAME und eine IMAGE geben.","text":"<p><code>kubectl get pods -o=custom-columns='PODNAME:.metadata.name,IMAGE:.spec.containers[*].image'</code></p> <p><code>[*]</code> heisst alles</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a4%20CKAD%20formatting%20output%20with%20kubectl/a4%20CKAD%20Formatting%20output%20with%20kubectl/#zeige-alle-resourcen-in-deinem-namespace-an","title":"Zeige alle resourcen in deinem Namespace an","text":"<p><code>kubectl get all -n default</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a4%20CKAD%20formatting%20output%20with%20kubectl/a4%20CKAD%20Formatting%20output%20with%20kubectl/#bonus-zeige-den-namen-und-das-image-aller-pods-an-ohne-spalten-namen","title":"Bonus: Zeige den Namen und das Image aller Pods an ohne Spalten-Namen.","text":"<p><code>kubectl get pods -o=custom-columns=':.metadata.name,:.spec.containers[*].image'</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a5%20CKAD%20Namespaces/a5%20CKAD%20namespaces%20howto/","title":"a5 CKAD namespaces howto","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a5%20CKAD%20Namespaces/a5%20CKAD%20namespaces%20howto/#erstelle-zwei-namespaces","title":"Erstelle zwei Namespaces","text":"<pre><code>kubectl create namespace namespace-frontend-1\nkubectl create namespace namespace-redis-2\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a5%20CKAD%20Namespaces/a5%20CKAD%20namespaces%20howto/#deploy-das-frontend-in-namespace-1-und-redis-in-namespace-2","title":"Deploy das Frontend in Namespace 1 und redis in Namespace 2","text":"<p>Obsidian: a5-ckad-namespaces-redis-yml</p> <p>sonstige: <code>./a5-ckad-namespaces-redis.yml</code></p> <p>und </p> <p>Obsidian: a5-ckad-namespaces-frontend</p> <p>sonstige: <code>./a5-ckad-namespaces-frontend.yml</code></p> <p>und</p> <p>Obsidian: a5-ckad-namespaces-redis-follower</p> <p>andere: <code>./a5-ckad-namespaces-redis-follower.yml</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a5%20CKAD%20Namespaces/a5%20CKAD%20namespaces%20howto/#erstellen","title":"Erstellen","text":"<p><code>kubectl create -f a5-ckad-namespaces-redis.yml</code></p> <p><code>kubectl create -f a5-ckad-namespaces-redis-follower.yml</code></p> <p><code>kubectl create -f a5-ckad-namespaces-frontend.yml</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a6%20CKAD%20env/a6%20CKAD%20env%20howto/","title":"a6 CKAD env howto","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a6%20CKAD%20env/a6%20CKAD%20env%20howto/#fuge-deinen-deployments-eine-environment-variable-hinzu","title":"f\u00fcge deinen Deployments eine Environment Variable hinzu","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a6%20CKAD%20env/a6%20CKAD%20env%20howto/#bearbeiten-der-yamls","title":"Bearbeiten der yamls","text":"<p>f\u00fcr jedes yaml file:</p> <p><code>nvim a6-ckad-namespaces-redis-follower.yml</code></p> <p>unter <code>containers:</code> <code>- image:</code></p> <pre><code>...\nenv:\n- name: namederenvv\n  value: wertderenvv\n</code></pre> <p>Diesen schritt f\u00fcr alle drei yaml files weiderholen.</p> <p><code>kubectl apply -f yamlname.yml</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a7%20CKAD%20config%20maps/a7%20CKAD%20config%20maps%20howto/","title":"a7 CKAD config maps howto","text":"<p>CKAD Config Maps</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a7%20CKAD%20config%20maps/a7%20CKAD%20config%20maps%20howto/#fuge-deinem-deployment-eine-environment-variable-hinzu-welche-aus-einer-configmap-kommt","title":"F\u00fcge deinem Deployment eine Environment Variable hinzu, welche aus einer Configmap kommt","text":"<p>Namespace!!</p> <p>When running into non working configmaps, check if the configmap is in the correct namespace.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a7%20CKAD%20config%20maps/a7%20CKAD%20config%20maps%20howto/#1-config-map-yaml-erstellen","title":"1. Config map yaml erstellen","text":"<p><code>kubectl create configmap -n namespace-frontend-1 -o yaml --dryrun=client --from-literal=var1=valuesome &gt; name.yml</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a7%20CKAD%20config%20maps/a7%20CKAD%20config%20maps%20howto/#2-config-map-erstellen","title":"2. Config map erstellen","text":"<p><code>kubectl create -f name.yml</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a7%20CKAD%20config%20maps/a7%20CKAD%20config%20maps%20howto/#uberprufen-ob-env-gesetzt-wurde","title":"\u00dcberpr\u00fcfen ob env gesetzt wurde:","text":"<p><code>kubectl exec -n namespace-frontend-1 frontend-6d7f9c6c6f-f4rdf -- /bin/bash -c 'echo $var1'</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a7%20CKAD%20config%20maps/a7%20CKAD%20config%20maps%20howto/#speichere-deine-indexhtml-in-eine-configmap-und-mounte-sie-in-deine-deployment-pods","title":"Speichere deine Index.html in eine ConfigMap und mounte sie in deine Deployment Pods","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a7%20CKAD%20config%20maps/a7%20CKAD%20config%20maps%20howto/#1st-try","title":"1st try","text":"<p>The index html is successfully mounted into the container, however all the other files in the html folder got deleted by the configmap:</p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a7%20CKAD%20config%20maps/a7%20CKAD%20config%20maps%20howto/#2nd-try","title":"2nd try","text":"<p>added <code>subPath: index.html</code> to the <code>volumeMounts</code> section (deployment yaml).</p> <p><code>kubectl apply -f deployment-yaml-file.yml</code></p> <p>Port Forward:</p> <p><code>kubectl port-forward -n namespace-frontend-1 frontend-5755c5c699-9z5mm 5000:80</code></p> <p></p> <p>a7-ckad-namespaces-frontend</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/","title":"a8 CKAD secrets howto","text":"<p>secrets (CKAD)))).md)</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/#fuge-deinem-deployment-eine-environment-variable-hinzu-welche-aus-einen-secret-kommt","title":"F\u00fcge deinem Deployment eine Environment Variable hinzu, welche aus einen Secret kommt:","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/#secret-creation","title":"Secret Creation:","text":"<p><code>kubectl create secret generic -n namespace-frontend-1 --from-literal notpassword=123issecure maisegret -o yaml --dry-run=client &gt; secret.yml</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/#pod-injection","title":"Pod injection","text":"<pre><code>envFrom:\n- configMapRef:\n  name: confmap1\n- secretRef:\n  name: maisegret\n</code></pre> <p><code>kubectl apply -f a7-deployment.yml</code></p> <p>a8-secrets-frontend</p> <p>a8-secrets-secret</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/#verification","title":"Verification:","text":"<p><code>kubectl exec -n namespace-frontend-1 frontend-65f7cfb7cd-9fqjk -- /bin/bash -c 'echo $notpassword'</code></p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/#speichere-deine-indexhtml-in-ein-secret-und-mounte-sie-in-deine-deployment-pods","title":"Speichere deine Index.html in ein Secret und mounte sie in deine Deployment Pods:","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/#1-secret-creation","title":"1. Secret creation:","text":"<p><code>kubectl create secret generic -n namespace-frontend-1 --from-file a8-randomhtml.html --dry-run=client -o yaml a8-html-secret &gt; a8-html-in-secret-secret.yml</code></p> <p>Im secret unter <code>data:</code> <code>a8-randomhtml.html</code> zu <code>index.html</code> \u00e4ndern.</p> <p><code>kubectl create -f a8-html-in-secret-secret.yml</code></p> <p>Siehe:</p> <p>./a8-html-in-secret-secret.yml</p> <p>./a8-randomhtml.yml</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/#2-pod-mount","title":"2. Pod mount:","text":"<p>See ./a8-secrets-frontend-html-mount.yml</p> <p>Similar to a7 CKAD config maps just that under <code>volumes:</code> its <code>secret:</code> and <code>secretName:</code> instead of <code>configMap:</code> and <code>name:</code>.</p> <p>Apply changes:</p> <p><code>kubectl apply -f a8-secrets-frontend-html-mount.yml</code></p> <p>Port Forward to test:</p> <p><code>kubectl port-forward -n namespace-frontend-1 frontend-5f49b75689-cjv27 5000:80</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a8%20CKAD%20Secrets/a8%20CKAD%20secrets%20howto/#3-test","title":"3. Test:","text":"Index.html <p>Does under data the key from the key value pair have to be index.html?  With another name, following error showed up:</p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/","title":"CKAD SOPS","text":"<p>Secrets OPerationS</p> <p>is an editor of encrypted files that supports YAML, JSON, ENV, INI and BINARY formats and encrypts with AWS KMS, GCP KMS, Azure Key Vault, age, and PGP. (demo)</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/#erstelle-fur-dich-ein-gpg-schlussel-paar-rsa-4096bit-mit-deiner-email","title":"Erstelle f\u00fcr dich ein GPG Schl\u00fcssel-paar (RSA 4096Bit) mit deiner Email","text":"<p>GPG</p> <pre><code>gpg --full-gen-key\n</code></pre> <p></p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/#public-key-exportieren","title":"Public Key exportieren","text":"<ol> <li>Key id finden </li> </ol> <pre><code>gpg --list-secret-keys --keyid-format long &lt;email&gt;\n</code></pre> <ol> <li><code>gpg --armor --export &lt;id&gt; &gt; file</code></li> </ol>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/#lege-eine-secret-configuration-fur-kubernetes-an-die-so-auch-in-der-realitat-vorkommen-konnte","title":"Lege eine Secret-Configuration f\u00fcr Kubernetes an, die so auch in der Realit\u00e4t vorkommen k\u00f6nnte","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/#1-secret-aus-key-file-erstellen","title":"1. Secret aus key file erstellen","text":"<pre><code>kubectl create secret generic --from-file pub.key maiaccount -n namespace-frontend-1 --dry-run=client -o yaml &gt; maiaccount.yml\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/#verschlussele-diese-mit-sops-und-deinem-gpg-key","title":"Verschl\u00fcssele diese mit SOPS und deinem GPG Key","text":"<pre><code>sops --encrypt --pgp=gpgid filename.yml &gt; encryptdfilename\n</code></pre> <p>GPG</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/#enschlussle-die-datei-wieder","title":"Enschl\u00fcssle die datei wieder","text":"<p><pre><code>sops -d secrets.enc.yaml\n</code></pre> password was entered</p> <p></p> <p>On the left: decrypted key, on the right non encrypted key</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/#bonus-why-should-secrets-be-encrypted","title":"Bonus (why should secrets be encrypted)","text":"<p>Answer</p> <p>Kubernetes by default encodes secrets using base 64. Files are not human readable but anyone can decode them to human readable again. since secrets can store information like passwords, they should not be accessible. However maybe you want your secrets to be e.g on git. Then encryption can help.b</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/CKAD%20SOPS/#explained-for-later","title":"Explained for later:","text":"<ol> <li>Public Key (email) GPG was created</li> <li>K8s secret containing Public key was created</li> <li>Another GPG Key was created (not really)</li> <li>K8s secret was encrypted using sops and the gpg key</li> <li>Encrypted file was decrypted using sops again (with password)</li> </ol>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/GPG/","title":"GPG","text":"<p>GnuPrivacyGuard</p> <p>GnuPG allows you to encrypt and sign your data and communications; it features a versatile key management system, along with access modules for all kinds of public key directories. GnuPG, also known as GPG, is a command line tool with features for easy integration with other applications.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/GPG/#install-gpg","title":"Install gpg","text":"<p>Was already installed</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/GPG/#create-4096-bit-rsa-key","title":"Create 4096 bit RSA key","text":"<p><code>gpg --full-gen-key</code></p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/GPG/#list-gpg-key","title":"List GPG Key","text":"<ol> <li> <p><code>gpg --list-secret-keys --keyid-format long &lt;EMAIL&gt;</code></p> </li> <li> <p>Copy the GPG key ID:</p> </li> </ol> <p></p> <ol> <li>show public Key <code>gpg --armor --export prevslCopiedId</code></li> </ol>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/GPG/#get-fingerprint-of-pub-key","title":"Get fingerprint of pub key","text":"<pre><code>gpg --fingerprint email.adress@gmail.com\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/SOPS/","title":"SOPS","text":"<p>https://github.com/getsops/sops/releases</p> <p>sops is an editor of encrypted files that supports YAML, JSON, ENV, INI and BINARY formats and encrypts with AWS KMS, GCP KMS, Azure Key Vault, age, and PGP. (demo)</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/SOPS/#installation","title":"installation","text":"<pre><code>sudo pacman -S sops\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/CKAD/aufgaben/a9%20CKAD%20Encrypting%20data%20at%20rest/a9%20CKAD%20Encrypting%20at%20rest%20Howto/","title":"a9 CKAD Encrypting at rest Howto","text":"<p>Verwendet Mozilla SOPS +\u00a0 GPG-Keys, um Secrets verschl\u00fcsselt abzulegen.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/prerequisites/PP%20prerequisites/","title":"PP prerequisites","text":"<ul> <li>[x] Setup local kubernetes cluster for testing</li> <li>[x] 2 Worker Nodes</li> <li>[x] max 15 min deletion and restoring time</li> <li>[x] Access to local registry</li> </ul> <p>Browser access</p> <p>Do it via port forwarding until exercises after and during section services.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/prerequisites/PP%20prerequisites/#cluster-setup","title":"Cluster setup","text":""},{"location":"Praktische%20Projekte/auftraege/CKAD/prerequisites/PP%20prerequisites/#install-kind","title":"Install kind","text":"<ol> <li>Install <code>go</code> with command <code>sudo pacman -S go</code></li> <li>(install docker <code>sudo pacman -S docker</code>)</li> <li>Install kind using go <code>go install sigs.k8s.io/kind@v0.20.0</code></li> <li>Add kind (go env) <code>export PATH=\"/home/phonkd/go/bin:$PATH\"</code></li> </ol>"},{"location":"Praktische%20Projekte/auftraege/CKAD/prerequisites/PP%20prerequisites/#cluster-creation","title":"Cluster creation","text":"<ol> <li>Edit kind-config</li> <li>Run command <code>kind create cluster --config=./kind-config.yml</code></li> <li>Install kubectl Kubectl</li> <li>Verify with <code>kubectl get nodes</code></li> </ol>"},{"location":"Praktische%20Projekte/auftraege/CKAD/prerequisites/PP%20prerequisites/#setup-registry","title":"Setup registry","text":"<ol> <li>Install Docker-Compose</li> <li>Run docker compose (this one): a4-docker-compose,</li> <li>Push the image by running <code>docker build -t localhost:5000/gb-frontend-phonkd:v1 .</code></li> <li>Verify by trying to run from registry <code>kubectl run --image localhost:5000/gb-frontend-phonkd test</code></li> </ol> <p>Kind pod can't access Registry, neither registry run with compose nor inside of kind pod with service.</p>"},{"location":"Praktische%20Projekte/auftraege/CKAD/prerequisites/PP%20prerequisites/#troubleshooting","title":"Troubleshooting","text":"<p><code>/etc/resolv.conf</code></p> <p>The nameserver for the kind nodes gets set on cluster creation. If the network configuration on the host changes, these changes don't get applied to the nodes. therefore recreate the cluster. <code>kind delete cluster --name phonkd</code> <code>kind create cluster --name phonkd --config ...</code></p>"},{"location":"Praktische%20Projekte/auftraege/docker%20security/Hacking%20a%20docker%20container/","title":"Hacking a docker container","text":"<p>Docker isolates processes in CGROuPS.</p> <p></p>"},{"location":"Praktische%20Projekte/auftraege/docker%20security/Hacking%20a%20docker%20container/#gihuub","title":"GIhuub","text":"<p>https://github.com/Swordfish-Security/Pentest-In-Docker</p>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/Theorie/Trivy/","title":"Trivy","text":"<p>Tool zum scannen von docker images auf sicherheitsl\u00fccken</p> <pre><code>sudo pacman -S trivy\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a1%20Creating%20a%20new%20docker%20image/a1%20howto/","title":"A1 howto","text":"<ol> <li>Create dockerfile a1-dockerfile</li> <li>Build</li> </ol> <p><pre><code>docker build -t v5-sel --network=host .\n</code></pre> 3. Test (run)</p> <p><pre><code>docker run -d imageid\n</code></pre> 4. Scan image</p> <pre><code>trivy image 041 | grep total\n</code></pre> <p>Result:</p> <pre><code>Total: 1036 (UNKNOWN: 1, LOW: 723, MEDIUM: 135, HIGH: 172, CRITICAL: 5)\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a1%20Creating%20a%20new%20docker%20image/a1%20howto/#dive","title":"Dive","text":""},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a2%20Docker%20run%20and%20Env%20variables/a2%20howto/","title":"A2 howto","text":""},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a2%20Docker%20run%20and%20Env%20variables/a2%20howto/#1-php_ini_dir-herausfinden","title":"1. PHP_INI_DIR herausfinden","text":"<pre><code>docker inspect containerid | grep PHP_INI_DIR\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a2%20Docker%20run%20and%20Env%20variables/a2%20howto/#2-container-mit-env-set_manualtrue","title":"2. Container mit env set_manual=true","text":"<pre><code>docker run -d -e SET_MANUAL=true 176\ndocker inspect containerid | grep SET_MANUAL=\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a2%20Docker%20run%20and%20Env%20variables/a2%20howto/#3-env-im-image-build","title":"3. ENV im image build","text":"<ol> <li>Im Dockerfile hinzuf\u00fcgen:</li> </ol> <pre><code>ENV PRAKTIKUM=true\n</code></pre> <ol> <li>Neu Builden</li> </ol> <pre><code>docker build -t v5-sel-env --network=host .\n</code></pre> <ol> <li>Test    <code>docker inspect imageid | grep PRAKTIKUM</code></li> </ol>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a2%20Docker%20run%20and%20Env%20variables/a2%20howto/#4-env-bei-start-ausgeben","title":"4. Env bei start ausgeben","text":"<ol> <li>Dockerfile dies hinzuf\u00fcgen:</li> </ol> <pre><code>CMD echo $PRAKTIKUM $PHP_INI_DIR\n</code></pre> <ol> <li>Build</li> </ol> <pre><code>docker build -t v5-sel-env-echo --network=host .\n</code></pre> <ol> <li>Run</li> </ol> <pre><code>docker run imageid\n</code></pre>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a3%20CMD%20vs%20Entrypoint/a3%20howto/","title":"A3 howto","text":"<p>Schau dir das gb-frontend Image nochmal genauer an. Fokusiere dich dabei auf Entrypoint und Cmd.</p> <ol> <li>Was ist generell der Unterschied zwischen den beiden Operationen. Wann eignet sich welche?</li> </ol> <p>Answer</p> <p>Der Entrypoint is flexibler und besser geeignet wenn man dem Command einnen Parameter mitgeben will. Mit einem <code>CMD</code> nach dem Entrypoint kann eine Default value gesetzt werden welche nur eingesetzt wird wenn beim starten des Containers kein anderer Parameter mitgegeben wird.</p> <ol> <li>Starte einen Container und \u00fcberschreibe den Befehl welcher dabei ausgef\u00fchrt wird. Welche M\u00f6glichkeiten gibt es hier und was stellst du fest? </li> </ol> <p>Answer</p> <p><code>docker run --entrypoint echo c62 \"hallo\"</code> Man k\u00f6nnte auch nur hallo schreiben, dann w\u00fcrde der im image gesetzte entrypoint + hallo ausgef\u00fchrt werden. Alternativ kann man in seinem eigenen Image den <code>Entrypoint</code> sowie auch <code>CMD</code> setzten.</p> <ol> <li>Erstelle ein neues Image, z.b basierend auf Debian:latest. Adde zun\u00e4chst einfach eine ENTRYPOINT Instruction (echo eignet sich f\u00fcr die Visualisierung der Unterschiede) </li> </ol> <p>3.1. Was wenn du den Befehl nun versuchst zu \u00fcberschreiben beim Starten eines Containers?</p> <p>Answer</p> <p><code>docker run imageid thisgetsechoed</code> Wichtig: <code>ENTRYPOINT [\"\"]</code> so angeben     </p> <p>3.2 Was geschieht, wenn du ENTRYPOINT und CMD setzt?</p> <p>Answer</p> <p>Wenn kein parameter beim <code>docker run</code> befehl mitgegeben wird, wird der werd von der <code>CMD</code> instruction genommen.</p> <p>3.3 Setze jetzt mal nur CMD. Was stellst du fest?</p> <p>Answer</p> <p>Der befehl wird beim Start des containers ausgef\u00fchrt.</p> <ol> <li>Betrachtest du die verwendete Option beim gb-frontend als sinnvoll? Warum/Warum nicht?</li> </ol> <p>[!answer]</p> <p>Ich finde die verwendete Variante Sinnvoll <code>CMD</code>, da der Container mit anderen Startoptionen wohl nicht funktionieren w\u00fcrde.</p>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a4%20Docker%20Registry/a4%20howto/","title":"A4 howto","text":""},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a4%20Docker%20Registry/a4%20howto/#starte-eine-lokale-registry","title":"Starte eine Lokale registry","text":"<p><code>docker run -d -p 5000:5000 --name ownreg registry</code></p>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a4%20Docker%20Registry/a4%20howto/#pushe-eigenes-gb-frontend-image-darauf","title":"Pushe eigenes gb-frontend image darauf","text":"<p>a4-dockerfile</p> <ol> <li> <p>Image taggen    <code>docker image tag imageid localhost:5000/sleeper</code></p> </li> <li> <p>Image pushen    <code>docker push localhost:5000/sleeper</code></p> </li> </ol>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a4%20Docker%20Registry/a4%20howto/#bonus-mit-compose","title":"Bonus mit compose","text":"<ol> <li> <p>Siehe a4-docker-compose</p> </li> <li> <p><code>docker-compose up -d</code></p> </li> </ol> <p>Hat sleeper tag? Bei erneutem Push tag?</p>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a5%20Docker%20compose/a5%20howto/","title":"A5 howto","text":"<ol> <li>Erstelle eine Docker-Compose Datei, die sowohl dein Image als auch Redis\u00a0beinhaltet.     (Redis soll mindestens aus zwei Komponenten bestehen: einem Leader (Image: docker.io/redis:6.0.5) und einen Follower (Image: gcr.io/google_samples/gb-redis-follower:v2) </li> </ol> <p>Answer</p> <p>Siehe a5-docker-compose Eigenes image kam aus eigener registry a4 howto</p> <ol> <li>Sorge daf\u00fcr das das gb-frontend im browser aufgerufen werden kann:</li> </ol> <p>Answer</p> <p>Siehe a5-docker-compose (<code>ports:</code>)</p>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a5%20Docker%20compose/a5%20howto/#bonus","title":"Bonus","text":"<ol> <li>verifiziere auch, dass redis aus deinem gb-frontend heraus ansprechbar ist.</li> </ol> <p>[!answer]</p> <p>Siehe <code>./docker-compose.yml</code> (<code>links: ...</code>)</p>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a6%20storage/a6%20howto/","title":"A6 howto","text":"<ol> <li>Starte den gb-frontend container und nehme \u00e4nderungen an <code>index.html</code> vor.</li> </ol> <p>Answer</p> <pre><code>docker compose up -d\ndocker exec -it containerid bash\napt install vim\nvim index.html\n</code></pre> <ol> <li>Rufe die website auf, kannst du die \u00e4nderung sehen?</li> </ol> <p>[!answer] Ja</p> <ol> <li>starte den container neu, kannst du die \u00e4nderungen sehen?</li> </ol> <p>Answer</p> <p><pre><code>docker stop 930\ndocker start 930\n</code></pre> ja</p> <ol> <li>Kopiere die index.html datei auf deine Workstation</li> </ol> <pre><code>docker cp 930:/var/www/html/index.html .\n</code></pre> <ol> <li> <p>Mache eine anpassung an <code>index.html</code> </p> <p>[!answer]</p> <p>(siehe a6-index)</p> </li> <li> <p>Mounte die datei nach /var/www/html </p> <p>[!answer]</p> <p>siehe a6-docker-compose</p> </li> <li> <p>Kannst du die \u00e4nderungen sehen?</p> </li> </ol> <p>Answer</p> <p>Ja</p> <ol> <li>Passe die selbe datei in dem container an, was passier mit der lokalen datei?</li> </ol> <p>[!answer]</p> <p>Sie wird lokal auch ge\u00e4ndert</p> <ol> <li>Verhindere das zur runtime des cotainers \u00e4nderungen an index.html vorgenommen werden k\u00f6nnen</li> </ol> <p>HOW ?</p> <p>Docker Volume einstellung in docker-compose: <pre><code>volumes:\n     - type: bind\n       source: ./my-local-directory\n       target: /path/inside/container\n       read_only: true\n</code></pre></p>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a6%20storage/a6%20howto/#compose-redis-persistent-data-volume","title":"Compose Redis persistent data volume","text":"<ol> <li><code>volume</code> im compose hinzuf\u00fcgen (siehe a6-docker-compose)</li> <li>Warten bis redis automatisch <code>dump.rdb</code>saved oder <code>docker exec -it redismasterid redis-cli save</code></li> </ol>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a7%20Netzwerke/a7%20howto/","title":"A7 howto","text":""},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a7%20Netzwerke/a7%20howto/#vorbereitung","title":"Vorbereitung","text":"<p>Erstelle ein docker-compose in dem das Frontend mit dem redis \"spricht\". </p> <p>Das heisst: wenn Du in der App einen Guestbook Eintrag erstellst, sollte der in redis gespeichert werden (und im Browser entsprechend angezeigt werden).</p> <p>Da das Debuggen der App hier nicht die Hauptaufgabe ist Hinweis:</p> <p>Die Redis Hosts m\u00fcssen bestimmte Namen haben, damit die App automatisch darauf connecten kann: Der Redis Leader host muss \"redis-leader\" heissen und der Follower muss \"redis-follower\" heissen. Wenn die Guestbook Eintr\u00e4ge nicht gespeichert werden k\u00f6nnen, liegt es vermutlich daran, dass Du die services im docker-compose nicht so genannt hast.</p> <p>mehrere \"Netze\":</p> <ol> <li>Erstelle 2 unterschiedliche Subnetzen</li> <li>Das Frontend soll aus Subnetz 1 erreichbar sein und Redis darf nur im Subnetz 2 sein</li> <li>Stell sicher, dass das Frontend Redis erreicht.</li> </ol>"},{"location":"Praktische%20Projekte/auftraege/exercises%20with%20docker/a7%20Netzwerke/a7%20howto/#howto","title":"Howto","text":"<ol> <li>2 Netzwerke erstellen    <code>network:</code> siehe <code>./docker-compose.yml</code></li> <li><code>frontend</code> service zugriff auf beide netzwerke geben</li> <li><code>redis-leader</code> &amp; <code>redis-follower</code> dem netzwerk 2 hinzuf\u00fcgen</li> </ol>"},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/","title":"Helm Auftrag","text":""},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#package-the-gb-frontend-from-earlier-and-all-its-components-in-helm","title":"Package the gb-frontend from earlier and all its components in helm","text":""},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#make-following-values-configurable-in-valuesyaml","title":"Make following values configurable in values.yaml:","text":"<ul> <li>Port</li> <li>IP</li> </ul>"},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#helm-setup","title":"Helm Setup","text":"<p>After installing Helm via <code>sudo pacman -S helm</code> i was ready to create the helm chart.</p> <p><pre><code>helm create schaebig\n</code></pre> *This creates following directory tree: </p>"},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#understanding-templates","title":"Understanding Templates:","text":"<p>Templates is the folder where your classic yaml files for e.g deployments must be located. You then edit these templates and tell the values you want that they should grab the value from values.yaml: </p> <p>Find out how to do this by</p> <p>Searching the desired value in the pregenerated yaml template or the helm documentation.</p>"},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#understanding-valuesyaml","title":"Understanding Values.yaml","text":"<p>For the Templates to work, values must also be specified in the values.yaml file:</p> <p></p> <p>In my case i applied the config map, the image and the port via the values.yaml:</p> <p></p> <p></p> <p></p>"},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#ingress","title":"Ingress","text":"<p>Protip</p> <p>Install an ingress controller ffs Preferably also configure it... <code>sudo nvim /etc/var/lib/rancher/k3s/server/manifests/traefik-config.yml</code></p> <pre><code>&gt;apiVersion: helm.cattle.io/v1\nkind: HelmChartConfig\nmetadata:\n  name: traefik\n  namespace: kube-system\nspec:\n  valuesContent: |-\n    image:\n      name: traefik\n      tag: v2.8.5\n    forwardedHeaders:\n      enabled: true\n      trustedIPs:\n        - 10.0.0.0/8\n    ssl:\n      enabled: true\n      permanentRedirect: false\n    dashboard:\n      enabled: true\n      domain: dashboard.traefik.local  # replace with your preferred domain\n    additionalArguments:\n      - \"--api.insecure=true\"\n</code></pre>"},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#also","title":"Also:","text":"<p>Port forwarding rules</p>"},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#finally","title":"Finally","text":"<p><code>kubectl apply -f</code> ingress-frontend.yml</p>"},{"location":"Praktische%20Projekte/helm%20auftrag/Helm%20Auftrag/#disenable-ingress-in-valuesyml","title":"Dis/enable ingress in values.yml","text":"<p>Added Condition in ingress-frontend</p> <p>En/disable in values</p>"},{"location":"ckaord/CKA%20vs.%20CKAD/","title":"CKA vs. CKAD","text":"<p>s</p>"},{"location":"ckaord/CKA%20vs.%20CKAD/#ckad","title":"CKAD","text":"Domain Weight Application Design and Build 20% Application Deployment 20% Application Observability and Maintenance 15% Application Environment, Configuration and Security 25% Services and Networking 20%"},{"location":"ckaord/CKA%20vs.%20CKAD/#cka","title":"CKA","text":"Domain Weight Storage 10% Troubleshooting 30% Workloads &amp; Scheduling 15% Cluster Architecture, Installation &amp; Configuration 25% Serviceds % Networking"},{"location":"ckaord/CKA%20vs.%20CKAD/#offene-punkte","title":"Offene Punkte","text":"<ul> <li>[ ] Understand volume mode, access modes and reclaim policies for volumes</li> <li>[ ] Evaluate cluster and node logging</li> <li>[ ] Understand how to monitor applications</li> <li>[ ] Manage container stdout &amp; stderr logs</li> <li>[ ] Understand the primitives used to create robust, self-healing, application deployments</li> <li>[ ] Use Kubeadm to install a basic cluster</li> <li>[ ] Manage a highly-available Kubernetes cluster</li> <li>[ ] Implement etcd backup and restore</li> <li>[ ] Know how to configure and use CoreDNS</li> </ul>"},{"location":"ckaord/Lernziele/","title":"Lernziele","text":""},{"location":"ckaord/Lernziele/#storage","title":"Storage","text":"<ul> <li>[ ] Understand storage classes, persistent volumes  </li> <li>[ ] Understand volume mode, access modes and reclaim policies for volumes  </li> <li>[ ] Understand persistent volume claims primitive  </li> <li>[ ] Know how to configure applications with persistent storage</li> </ul>"},{"location":"ckaord/Lernziele/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>[ ] Evaluate cluster and node logging  </li> <li>[ ] Understand how to monitor applications  </li> <li>[ ] Manage container stdout &amp; stderr logs  </li> <li>[ ] Troubleshoot application failure  </li> <li>[ ] Troubleshoot cluster component failure  </li> <li>[ ] Troubleshoot networking</li> </ul>"},{"location":"ckaord/Lernziele/#workloads-scheduling","title":"Workloads &amp; Scheduling","text":"<ul> <li>[ ] Understand deployments and how to perform rolling update and rollbacks  </li> <li>[ ] Use ConfigMaps and Secrets to configure applications  </li> <li>[ ] Know how to scale applications  </li> <li>[ ] Understand the primitives used to create robust, self-healing, application deployments  </li> <li>[ ] Understand how resource limits can affect Pod scheduling  </li> <li>[ ] Awareness of manifest management and common templating tools</li> </ul>"},{"location":"ckaord/Lernziele/#cluster-architecture-installation-configuration","title":"Cluster Architecture installation &amp; COnfiguration","text":"<ul> <li>[ ] Manage role based access control (RBAC)  </li> <li>[ ] Use Kubeadm to install a basic cluster  </li> <li>[ ] Manage a highly-available Kubernetes cluster  </li> <li>[ ] Provision underlying infrastructure to deploy a Kubernetes cluster  </li> <li>[ ] Perform a version upgrade on a Kubernetes cluster using Kubeadm  </li> <li>[ ] Implement etcd backup and restore</li> </ul>"},{"location":"ckaord/Lernziele/#services-networking","title":"Services &amp; Networking","text":"<ul> <li>[ ] Understand host networking configuration on the cluster nodes  </li> <li>[ ] Understand connectivity between Pods  </li> <li>[ ] Understand ClusterIP, NodePort, LoadBalancer service types and endpoints  </li> <li>[ ] Know how to use Ingress controllers and Ingress resources  </li> <li>[ ] Know how to configure and use CoreDNS  </li> <li>[ ] Choose an appropriate container network interface plugin</li> </ul>"},{"location":"ckaord/cka/Container%20Runtimes%20and%20their%20ctl/","title":"Container Runtimes and their ctl","text":""},{"location":"ckaord/cka/Container%20Runtimes%20and%20their%20ctl/#history","title":"History","text":"<p>In the early days of kubernetes, kubernetes was built to run with docker. At some point, many people wanted kubernetes to support other container runtimes. So then docker decided to build a container runtime Interface (CRI).</p>"},{"location":"ckaord/cka/Container%20Runtimes%20and%20their%20ctl/#differenct-ctls","title":"Differenct ctls","text":""},{"location":"ckaord/cka/ETCD/","title":"ETCD","text":""},{"location":"ckaord/cka/ETCD/#what-is-a-key-value-store","title":"What is a key value store","text":""},{"location":"docker/docker%20cp/","title":"Docker cp","text":"<pre><code>docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH|-\ndocker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH\n</code></pre>"},{"location":"docker/docker%20kurs%20Info/","title":"docker kurs Info","text":"<p>Diese Dokumentation enthaltet w\u00e4hrend dem Docker udemy kurs gelerntes.</p> <p>Informationen wurden in abschnitte (A2-A...) aufgeteilt.</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20Rm/","title":"basics","text":""},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20Rm/#usage","title":"Usage:","text":"<p>remove a container <pre><code>docker rm  name/containerid\n</code></pre></p> <p>Warning</p> <p>stop containers first</p> <p>Delete all containers `docker rm $(docker ps -aq)</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20Stop/","title":"basics","text":"<p>Stops runnng container</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20Stop/#usage","title":"usage","text":"<pre><code>docker stop name/ID\n</code></pre>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20container/","title":"basics","text":"<p>Note</p> <p>Container ID sometimes = the hostname of the container </p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20images/","title":"basics","text":""},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20images/#list-docker-images","title":"List docker images:","text":"<p>`docker images</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20images/#delete-docker-images","title":"Delete docker images:","text":"<p><code>docker rmi ubuntu</code></p> <p>Warning</p> <p>Stop all containers using this image first</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20images/#delete-all-images-without-container","title":"Delete all images without container:","text":"<p>`docker image prune -a</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20info%20command/","title":"basics","text":"<p>List information about your docker installation</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20ps/","title":"basics","text":"<p>Lists running Containers. More here: docker inspect</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20pull/","title":"basics","text":"<p>Pull a docker image and store it on the local machine.</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20run/","title":"basics","text":"<p>Runs a docker image.</p> <p>Info</p> <p>Image gets pulled from dockerhub if it doesnt exist locally or specified otherwise</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20run/#usage","title":"Usage:","text":"<p>`docker run -d (if background) image:tag </p> <p>Note</p> <p>Docker containers stop immediatly as soon as its job is stopped (e.g webserver)</p> <p>Run bash in a container and connect automartically: `docker run -it alpine bash</p> <p>Run container without stopping for 20s `docker run -d image sleep 20s</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20run/#flags","title":"Flags:","text":"Flag does -i interactive (input) -t Attach terminal --name name the container -v Volume Mapping docker volumes -e Environement Variables --entrypoint Set the entrypoint from the docker run CMD &amp; Entrypoint --link docker run --links --restart set restart police e.g (always, unless stopped,...) -H= Set host where to execute docker commanddocker engine --cpus= limit cpu usage cgroups (control groups)))).md) --memory= limit memory usage cgroups (control groups)))).md) --mount newer version of -v --network set one of the 3 networks docker uses (default=bridge) <p>Port mapping see:  Port mapping</p>"},{"location":"docker/a2/Basic%20Docker%20Commands/Docker%20version/","title":"basics","text":"<p>c abv</p>"},{"location":"docker/a3/Access%20docker%20container/","title":"Access docker container","text":""},{"location":"docker/a3/Access%20docker%20container/#local-via-ip","title":"Local (via IP):","text":"<ol> <li>Get ip adress `docker inspect containerid | grep \"IPAddress\"</li> <li>get port `docker ps</li> <li>Access `ipadress:port</li> </ol>"},{"location":"docker/a3/Access%20docker%20container/#via-docker-host-ipport","title":"Via docker host ip:port","text":"<p>`docker run -p hostport:containerport me/mywebapp</p>"},{"location":"docker/a3/Docker%20attach/","title":"Docker attach","text":"<p>same as using Docker run without -d flag</p>"},{"location":"docker/a3/Port%20mapping%20%28docker%20run%29/","title":"Port mapping (docker run)","text":"<p>Docker run</p> <p>Warning</p> <p>Docker Containers running without specified port, are only accessible inside the docker host. (computer runing the container)</p>"},{"location":"docker/a3/Port%20mapping%20%28docker%20run%29/#access-eg-webapp-via-dockerhostipcontainerport","title":"Access e.g Webapp via dockerhostIP:containerport","text":"<p>`docker run -p hostport:containerport me/mywebapp</p>"},{"location":"docker/a3/Volume%20Mapping/","title":"Volume Mapping","text":"<p>after a docker container is removed, the data is gone. *To keep data after container removal you can map a directory from the container to a local folder. `docker run -v /path/on/local/machine:/path/in/container image</p>"},{"location":"docker/a3/docker%20inspect/","title":"Docker inspect","text":"<p>Docker ps Container information in the json format</p>"},{"location":"docker/a3/docker%20inspect/#usage","title":"Usage:","text":"<p><code>docker inspect</code> Containerid</p>"},{"location":"docker/a3/docker%20logs/","title":"Docker logs","text":""},{"location":"docker/a3/docker%20logs/#usage","title":"Usage","text":"<p>`docker logs containernameorid</p>"},{"location":"docker/a4/CMD%20%26%20Entrypoint/","title":"CMD & Entrypoint","text":""},{"location":"docker/a4/CMD%20%26%20Entrypoint/#cmd-usage","title":"CMD usage","text":"<p>`CMD sleep 100 OR: CMD [\"sleep\", \"100\"] (Command, parameter)</p>"},{"location":"docker/a4/CMD%20%26%20Entrypoint/#entrypoint-usage","title":"Entrypoint usage","text":"<p><pre><code>...\nENTRYPOINT [\"sleep\"]\n</code></pre> With the above  Docekrfile: <code>docker run my-image 100</code> runs <code>sleep 100</code> after starting the container. If no value is given (<code>docker run my-image)</code> you will get an error. To provide a default value append <code>CMD [\"5\"]</code> in JSON format to the dockerfile <pre><code>...\nENTRYPOINT [\"sleep\"]\nCMD[\"5\"]\n</code></pre> Or replace the entire entrypoint with the --entrypoint flag: `docker run --entrypoint sleep my-image 21</p>"},{"location":"docker/a4/Docker%20build/","title":"Docker build","text":"<p>Build image from docs/Praktische Projekte/auftraege/exercises with docker/a1 Creating a new docker image/Dockerfile</p> <ol> <li>Create Dockerfile</li> <li>`docker build .</li> </ol> <p>Name Image: `docker build -t irgendeinname .</p> <p>Name and Tag image: `docker build -t irgendeinname:latest .</p>"},{"location":"docker/a4/Dockerfile/","title":"Dockerfile","text":"<p>Always Instruction argument </p>"},{"location":"docker/a4/Dockerfile/#from","title":"From","text":"<p>Specify the base os e.g alpine:latest or ubuntu:20.04 <code>from</code>  `image</p>"},{"location":"docker/a4/Dockerfile/#run","title":"RUN","text":"<p>executes a command while building the image. `run any ccommand</p>"},{"location":"docker/a4/Dockerfile/#copy","title":"COPY","text":"<p>Copy a file from the local directory into the docker container `COPY /your/localdir /directory/on/the/container</p>"},{"location":"docker/a4/Dockerfile/#expose","title":"Expose","text":"<p>Specify container internal port</p>"},{"location":"docker/a4/Dockerfile/#entrypoint","title":"Entrypoint","text":"<p>Runs a command when the image is started. `ENTRYPOINT py main.py</p>"},{"location":"docker/a4/Environement%20Variables/","title":"Environement Variables","text":"<p>Info</p> <p>Variables like e.g the background_color in say a main.py script can be set to be environement variables.  By running <code>docker run -e APP_COLOR=blue image</code> the color variable in the script is set to blue. </p> <p>Info</p> <p>Find environenemt variables of running container: <pre><code>docker inspect container\n</code></pre> Unter \"Config\" -&gt; Env </p>"},{"location":"docker/a4/Find%20base%20OS%20of%20an%20image/","title":"Find base OS of an image","text":"<p>`docker run -it python:3.6 cat /etc/release</p>"},{"location":"docker/a4/docker%20push/","title":"Docker push","text":"<ol> <li>Docker login</li> <li>Tag image Docker build `docker build -t username/name(:tag) OR</li> <li>`docker push username/name(:tag)</li> </ol>"},{"location":"docker/a5/Docker%20networks/","title":"Docker networks","text":"<p>Have multiple networks in docker-compose for e.g separating traffic from front/backend</p>"},{"location":"docker/a5/Docker%20networks/#example","title":"Example","text":"<p>Database in back-end, alpinee service in frontend and in backend network. <pre><code>version: \"2\"\nservices:\n    db:\n        build: \"./phonkdmysql\"\n        networks:\n            - back-end\n    alpinee:\n        build: \"./alpine\"\n        networks:\n            - back-end\n            - front-end\n\nnetworks:\n    front-end:\n    back-end:\n</code></pre></p>"},{"location":"docker/a5/Docker-Compose/","title":"Docker Compose","text":""},{"location":"docker/a5/Docker-Compose/#warum","title":"Warum?","text":"<p>Problem: <pre><code>docker run phonkd/ubuntu\ndocker run phonkd/alpine\ndocker run phonkd/nginx\n</code></pre> L\u00f6sung:</p> <p><pre><code>version: \"2\"\nservices:\n    ubuntu:\n        image: \"phonkd/ubuntu\"\n    alpine:\n        image: \"phonkd/alpine\"\n    srv:\n        image: \"phonkd/nginx\"\n</code></pre> `docker-compose up -d </p>"},{"location":"docker/a5/Docker-Compose/#options","title":"options:","text":"option does example value image: specify docker image phonkd/ubuntu container_name: specify container name somename networks: specify what networks the container gets connected to. See Docker networks - backend version: specify docker-compose version \"2\" <p>Docker networks</p>"},{"location":"docker/a5/Links%20in%20compose.yml/","title":"Links in compose.yml","text":"<p>Make services in a docker compose file available to eachother Functions similar to docker run --links</p>"},{"location":"docker/a5/Links%20in%20compose.yml/#example","title":"Example:","text":"<pre><code>applikation:\n    image: phonkd/applikation\n    links:\n        - datenbank\ndatenbank:\n    image: phonkd/datenbank\n</code></pre>"},{"location":"docker/a5/Ports%20in%20compose.yml/","title":"Ports in compose.yml","text":"<p>similar to Port mapping (docker run)))).md)</p> <p>Open port 8080: <pre><code>applikation:\n    image: phonkd/applikation\n    ports:\n        - hostport:containerport\n    links:\n        - datenbank\ndatenbank:\n    image: phonkd/datenbank\n</code></pre></p>"},{"location":"docker/a5/docker%20compose%20build/","title":"Docker compose build","text":"<p>useful when the image is not yet on dockerhub or you want it to be build when running docker compose up</p> <p><pre><code>version: 2\nservices:\n    ubuntu:\n        image: \"phonkd/ubuntu\"\n    alpine:\n        image: \"phonkd/alpine\"\n    srv:\n        image: \"phonkd/nginx\"\n</code></pre> - Replace <code>image: \"phonkd/ubuntu\"</code>  with `build: \"path/to/directory/with/dockerfile\" <pre><code>version: \"2\"\nservices:\n    ubuntu:\n        build: \"./ubuntu\"\n    alpine:\n        build: \"./alpine\"\n    srv:\n        build: \"./nginx\"\n</code></pre></p>"},{"location":"docker/a5/docker%20compose%20versions/","title":"Docker compose versions","text":""},{"location":"docker/a5/docker%20compose%20versions/#version-1-vs-version-2","title":"Version 1 vs Version 2","text":"<p>Version1: <pre><code>ubuntu:\n    build: \"./ubuntu\"\nalpine:\n    build: \"./alpine\"\nsrv:\n    build: \"./nginx\"\n</code></pre></p> <p>Info</p> <p>Syntax: In version 2, everything is under <code>services:</code> You are also required to specify <code>version:</code> in version 2 and above. Networking: - In verstion 1 you link different services with eachother so they can communicate. - In version 2 all of the services are automatically linked and no <code>links:</code> needs to be specified.&gt;</p> <p>depends_on (version2 and above only): In version 2: -  By adding <code>depends_on:</code> to a service, it starts as soon as the dependency is running.      - E.g start the database as soon as the database with the name db is running.</p> <p>Version2: (start nginx as soon as alpinee is running) <pre><code>version: \"2\"\nservices:\n    ubuntu:\n        build: \"./ubuntu\"\n    srv:\n        build: \"./nginx\"\n        depends_on:alpinee\n    alpinee:\n        build: \"./alpine\"\n</code></pre></p>"},{"location":"docker/a5/docker%20compose%20versions/#version-2-vs-version-3","title":"Version 2 vs Version 3","text":""},{"location":"docker/a5/docker%20run%20--links/","title":"Docker run   links","text":"<p>to link containers with each other by their name</p> <p>Warning</p> <p>--links is a deprecated function with support running out soon as better alternatives are already here Docker Swarm</p> <p> this creates a host file entry inside of the container and inserts the link into it.</p>"},{"location":"docker/a6/Docker%20Registry/","title":"Docker Registry","text":""},{"location":"docker/a6/Docker%20Registry/#usage","title":"Usage:","text":"<p>Syntax: <code>image: registry/user_account/nginx **Example**</code>image: docker.io/phonkd/nginx</p> <p>Note</p> <p>If no registry is specified docker searches for the image on dockerhub.</p> <p>Example: <code>image: phonkd/ubuntu</code> takes image ubuntu from dockerhub user phonkd </p>"},{"location":"docker/a6/Docker%20Registry/#private-registry","title":"Private Registry","text":"<p>There are many other docker registries than docker hub. You can even host your own private registry. Login to docker registry:* `docker login private-registry.io</p> <p>Host own private registry: *Docker provides an image for hosting your own registry:  registry</p> <p>`docker run -d -p 5000:5000 --name ownreg registry</p> <p>Push to own docker registry: <code>mage tag my-image localhost:5000/my-image</code>docker push localhost:5000/my-image</p> <p>Pull image from own registry: `docker pull ipofregistryhost:5000/my-image</p>"},{"location":"docker/a7/--mount/","title":"mount","text":"<p>newer version of -v</p>"},{"location":"docker/a7/--mount/#usage","title":"Usage:","text":"<p>`docker run --mount type=bind,source=/path/to/local/folder,target=/folder/in/container image</p> <p>Info</p> <p>with mount you can bind files anywhere on the host.</p>"},{"location":"docker/a7/Docker%20File%20system/","title":"Docker File system","text":""},{"location":"docker/a7/Docker%20File%20system/#filesystem-on-docker-host","title":"Filesystem on docker host:","text":"<p>Upon installing docker, a folder with following contents will be created on the host: </p>"},{"location":"docker/a7/Docker%20namespaces/","title":"Docker namespaces","text":"<p>A linunx operating system starts with a PID (proccess ID) 1 and a bunch of following ids Processes in a docker container run directly on the host operating system. Inside the docker container the system also starts with PID 1. With a namespace the PID in the container can still be 1 while it is another numebr on the host.  Inside of a docker container the ID of a service is different from the id on the host even tho it  references the same process.</p>"},{"location":"docker/a7/Docker%20networking/","title":"Docker networking","text":"<p>Docker creates 3 networks automatically: - Bridge (default) - none (if <code>docker run image --network=none) - host (if</code>docker run image network=host) - User defined </p>"},{"location":"docker/a7/Docker%20networking/#bridge","title":"Bridge","text":"<p>Private internal Network of host  Containers get a private IP adress (usually 127.0.0.any). Access containers in bridge network - Map port from container to docker host</p>"},{"location":"docker/a7/Docker%20networking/#host","title":"Host","text":"<p>*A container running e.g apache with the option --network=host network wise is the same as running it directly (not in container).</p> <p>Warning</p> <p>This means you can run two containers at the same time that use the same port </p>"},{"location":"docker/a7/Docker%20networking/#none","title":"none","text":"<p>Isolated Network without access to the outside or any other containers</p>"},{"location":"docker/a7/Docker%20networking/#user-defined","title":"User defined","text":"<pre><code>docker network create \\\n-- driver bridge \\\n--subnet 182.18.0.0/16 (or other)\nname-of-my-network\n</code></pre>"},{"location":"docker/a7/Docker%20networking/#list-networks","title":"List networks","text":"<p><code>docker network ls **Network configuration of container:**</code>docker inspect containerid | grep \"NetworkMode\"</p>"},{"location":"docker/a7/Docker%20networking/#inspect-network","title":"Inspect network","text":"<p><code>docker network inspect</code> e.g `bridge</p>"},{"location":"docker/a7/Docker%20networking/#embedded-dns","title":"Embedded DNS:","text":"<p>Dockers DNS server IP: - 127.0.0.11 If two containers need to connect to eachother, using the IP adress is not recommended since restarting the container could change its IP. With dockers build in DNS server you can access other containers by their name.</p>"},{"location":"docker/a7/Layered%20architecture/","title":"Layered architecture","text":"<pre><code>FROM Ubuntu\nRUN apt-get update\nRUN apt-get -y install python\nCOPY . /opt/sourcecode\nEntrypoint\n</code></pre> <p>Docker images are layered. Each instruction in a dockerfile contains a layer. Each layer contains only the changes from the previous layer. So that if you add another instruction, it just adds another layer instead of rebuilding the entire thing. </p>"},{"location":"docker/a7/Storage%20Drivers/","title":"Storage Drivers","text":"<p>Are responsible for dockers storage (Volumes, mounts ...) Docker storage drivers: based on the operating system the best driver is automatically chosen - AUFS - ZFS - BTRFS - Device Mapper - Overlay - Overlay2 What storage driver am I using: `docker info | grep Storage </p>"},{"location":"docker/a7/cgroups%20%28control%20groups%29/","title":"Cgroups (control groups)","text":"<p>by default, docker containers are not restricted in how much resources they can use</p>"},{"location":"docker/a7/cgroups%20%28control%20groups%29/#cgroups","title":"Cgroups:","text":"<p>With cgroups you can manage your resources: Set Memory(RAM): <code>docker run --memory=1024m image</code> (max 1gb of ram) Set CPU's: <code>docker run --cpus=.5 image</code> (max 50% CPU Usage)</p>"},{"location":"docker/a7/docker%20engine/","title":"Docker engine","text":""},{"location":"docker/a7/docker%20engine/#remote","title":"remote","text":""},{"location":"docker/a7/docker%20engine/#docker-engine-layers","title":"Docker engine layers:","text":"<p> Docker Deamon: Manages volumes containers networks etc.</p> <p>Rest API: Is here to interact with the docker deamon and what makes the docker cli possible. You could write your own docker tools with the Rest API</p> <p>Docker CLI: Command line interface to interact with docker via the rest api. You can use the docker cli to control docker on other devices by using: <code>docker -H=host-or-ip-of-docker-engine-host:port</code> Example: <code>docker -H=192.168.1.132:2375 run nginx</code></p>"},{"location":"docker/a7/docker%20volumes/","title":"Docker volumes","text":""},{"location":"docker/a7/docker%20volumes/#create-volume","title":"create volume:","text":"<p>Note</p> <pre><code>docker volume create mis_volume\n</code></pre> <p>Creates a folder <code>/var/lib/mis_volume</code> and saves data in there</p>"},{"location":"docker/a7/docker%20volumes/#add-volume-to-container","title":"add volume to container:","text":"<p><code>docker run -v volumename:/path/to/where/you/want/in/container/ image</code></p> <p>!!!  info     If the volume specified in the run command does not exist, it will be created.</p>"},{"location":"docker/a7/docker%20volumes/#mount-any-folder-on-the-host-to-the-container-as-volume","title":"Mount any folder on the host to the container as volume:","text":"<p><code>docker run -v /path/to/your/folder/locally:incontainerfolder</code></p>"},{"location":"docker/a7/docker%20volumes/#in-compose","title":"in compose","text":"<pre><code>volumes:\n - ./index.html:/var/www/html/index.html\n</code></pre>"},{"location":"docker/a7/docker%20volumes/#read-only-volume-compose","title":"Read only volume (compose)","text":"<pre><code>version: '3'\nservices:\n  myservice:\n    image: myimage\n    volumes:\n      - type: volume\n        source: myvolume\n        target: /path/in/container\n        read_only: true\nvolumes:\n  myvolume:\n</code></pre>"},{"location":"docker/a9/Container%20Orchestration/","title":"Container Orchestration","text":"<p>Automatically starts stops containers how you have set it up. 3 Popular Solutions: - Docker Swarm Easy - Kubernetes Most popular Hard - MESOS Hard</p>"},{"location":"docker/a9/Docker%20Swarm/","title":"Docker Swarm","text":"<p>Solution for automatically managing containers, similar to kubernetes</p>"},{"location":"docker/a9/Docker%20Swarm/#requirements","title":"Requirements:","text":"<ul> <li>Multiple docker hosts</li> </ul> <p>Workers=nodes</p>"},{"location":"docker/a9/Docker%20Swarm/#setup","title":"Setup","text":"<ul> <li>Define Swarm manager</li> <li>Define Workers</li> <li>Run <code>docker swarm init</code> on swarm manager host</li> <li>Run <code>docker swarm join --token</code>\"token from swarm manager\" on all of the workers</li> </ul>"},{"location":"docker/a9/Docker%20Swarm/#docker-service","title":"Docker service","text":"<p>*Run an image distributed on the Docker swarm cluster\"</p> <p>Warning</p> <p>Commands must be run on Swarm manager</p> <p>Note</p> <p>Create a service (run image on cluster <pre><code>docker service create --replicas 21 my-image\n</code></pre> This command is similar to docker run so you can use many of the parameters</p>"},{"location":"docker/a9/Kubernetes%20high%20level/","title":"Kubernetes high level","text":"<p>*Kubernetes allows advanced autoscaling and rolling update and many more features.</p>"},{"location":"kubernetes/k8s%20for%20beginners%20Info/","title":"k8s for beginners Info","text":"<p>Diese Dokumentation enthaltet w\u00e4hrend dem kubernetes for absolute beginner udemy kurs gelernte Inhalte.</p> <p>Informationen wurden in abschnitte (A2-A...) aufgeteilt.</p>"},{"location":"kubernetes/A11%20Kubeadm/Kubeadm/","title":"Kubeadm","text":"<p>Kubeadm simplifies the process of setting up a multi node cluster in kubernetes.</p>"},{"location":"kubernetes/A11%20Kubeadm/Kubeadm/#setup","title":"setup","text":"<ol> <li> <p>Install containerd <code>sudo apt install containerd</code></p> </li> <li> <p>Install Kubeadm kubectl and kubelet: <pre><code>sudo apt-get install -y apt-transport-https ca-certificates curl\n</code></pre></p> </li> </ol> <pre><code>sudo mkdir /etc/apt/keyrings\n</code></pre> <pre><code>curl -fsSL https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-archive-keyring.gpg\n</code></pre> <pre><code>echo \"deb [signed-by=/etc/apt/keyrings/kubernetes-archive-keyring.gpg] https://apt.kubernetes.io/ kubernetes-xenial main\" | sudo tee /etc/apt/sources.list.d/kubernetes.list\n</code></pre> <pre><code>sudo apt-get update\nsudo apt-get install -y kubelet kubeadm kubectl\n</code></pre>"},{"location":"kubernetes/A2%20basics%26kubectl/Basic%20Terms/","title":"Basic Terms","text":"<ol> <li>Node:</li> <li>Physical or Virtual machine where Kubernetes is installed</li> <li>Containers are launched on nodes by kubernetes</li> <li> <p>Sometimes previously called Minions</p> </li> <li> <p>Cluster:</p> </li> <li>Group of multiple nodes</li> <li> <p>If one fails, the other ones jump in line </p> </li> <li> <p>Master:</p> </li> <li>Node</li> <li>Configured as master</li> <li>Watches the nodes and orchestrates the containers on all worker nodes</li> <li>Runs  kube-apiserver<ul> <li>Stores Data from kubelet on the etcd key value store</li> </ul> </li> <li>Worker Node    Components:<ul> <li>Container Runtime</li> <li>Kubelet (interacts with kube-apiserver)  Kubernetes components:</li> </ul> </li> <li>API Server<ul> <li>Enables communicating with the cluster (CLI...)</li> </ul> </li> <li>Etcd<ul> <li>Key Value Store<ul> <li>Responsible for storing data on all nodes (e.g Who the master is)</li> </ul> </li> </ul> </li> <li>kubelet<ul> <li>Agent running on all nodes</li> <li>Checks if all containers are running as expected</li> </ul> </li> <li>Scheduler<ul> <li>Distributes Containers on nodes</li> <li>Looks for newly created containers and assignes them to nodes</li> </ul> </li> <li>Controller<ul> <li>Responds to containers in error state or down (decide if new containers should be created)</li> </ul> </li> <li>Container Runtime<ul> <li>Docker</li> </ul> </li> </ol>"},{"location":"kubernetes/A2%20basics%26kubectl/Container%20Orchestration/","title":"Container Orchestration","text":"<p>Advantages: - High availability - User traffic is load balanced across nodes and containers - Automatically increase/decrease amount of instances according to demand - Rolling-Release update</p>"},{"location":"kubernetes/A2%20basics%26kubectl/Kubectl/","title":"Kubectl","text":"<p>=Kube commandline tool: </p> <p>Is used to deploy and manage applications on a kubernetes information</p> <p><code>kubectl run</code>: - Used to run applications on kubernetes cluster <code>Kubectl cluster info</code>: - Get information about cluster <code>kubectl get nodes</code>: - List all nodes of Cluster</p>"},{"location":"kubernetes/A2%20basics%26kubectl/Kubectl/#install","title":"install","text":"<ol> <li><code>sudo pacman -S kubectl</code></li> <li><code>touch ~/.kube/config</code></li> </ol>"},{"location":"kubernetes/A3%20pods/Delete%20pods/","title":"Delete pods","text":"<pre><code>kubectl delete pod name\n</code></pre>"},{"location":"kubernetes/A3%20pods/Kubectl%20edit/","title":"Kubectl edit","text":"<pre><code>shell\nkubectl edit pod redis\n</code></pre> <p>Edit replicaset: <pre><code>kubectl edit replicaset name\n</code></pre></p>"},{"location":"kubernetes/A3%20pods/Pods/","title":"Pods","text":"<p>In kubernetes, containers are not directly launched on the worker node, instead they get put into an object called pod. A pod: - is an instance of an application - can contain multiple containers. - is the smallest definable object in kubernetes</p>"},{"location":"kubernetes/A3%20pods/Pods/#syntax","title":"Syntax:","text":"<p>running images in k8s</p> <p>k8s:</p> <p>run the image nginx (dockerhub)</p> <pre><code>kubectl run anynamenginx --image=nginx\n</code></pre> list running pods <pre><code>kubectl get pods\n</code></pre> <p>Advanced (node, ip...)</p> <pre><code>kubectl get pods -o wide\n</code></pre> <p>(similar%20to%20%5Bdocker%20inspect.md))</p> <p>Syntax <pre><code>kubectl describe pod name\n</code></pre></p> <p>Dont increase the amount of containers  while scaling</p> <p>To increase the amount of instances of an application, you don't put in more containers in an image but create more pods.</p> <p>The only situation to use multiple containers in one pod: Multi-Container POD's</p>"},{"location":"kubernetes/A4%20yaml/List%20vs%20dictionaries/","title":"list #dictionary","text":""},{"location":"kubernetes/A4%20yaml/List%20vs%20dictionaries/#dictionaries-vs-lists","title":"Dictionaries vs lists:","text":"Property List Dictionary Ordered Yes unordered ## When to use lists and when to use dictionaries Use lists when you have multiple objects of the same kind: <pre><code>cars:\n - Blue Corvette\n - Grey Corvette\n - Red Corvette\n - Green Corvette\n - Blue Corvette\n</code></pre> <p>As soon as you want to save properties to these list items, use Dictionaries: <pre><code>- Color: blue \nModel:\n  Name: Corvette\n  Model: 1995\nTransmission: Manual\nPrice: $20000\n- Color: grey\nModel:\n  Name: corvette\n  Model: 1995\ntransmission: manual\nprice: 20000$\n</code></pre></p>"},{"location":"kubernetes/A4%20yaml/yaml/","title":"Yaml","text":""},{"location":"kubernetes/A4%20yaml/yaml/#syntax","title":"Syntax","text":"<p>`property: value <pre><code>fruit: apple\n</code></pre></p>"},{"location":"kubernetes/A4%20yaml/yaml/#arraylist","title":"Array(/list):","text":"<pre><code>Fruits:\n- Orange\n- Apple\n- Banana\n</code></pre>"},{"location":"kubernetes/A4%20yaml/yaml/#dictionary","title":"Dictionary:","text":"<p>Example <pre><code>Banana:\n    calories: 105\n    fat: 0.4g\n    Carbs: 27 g\n</code></pre> Example 2: (Note: Projects is a list inside of the dictionary) <pre><code>Employee:\n    Name: Jacob\n    Sex: Male\n    Age: 30\n    Title: System Engineer\n    Projects:\n        - Automation\n        - Support\n</code></pre> Example 3</p> <p>Ordered:</p> <pre><code>Employee:\n Name: Jacob\n Sex: Male\n Age: 30\n Title: Systems Engineer\n Projects:\n   - Automation\n   - Support\n Payslips:\n   - Month: June \n     Wage: 4000\n   - Month: July\n     Wage: 4500\n   - Month: August\n     Wage: 4000\n</code></pre> <p>Warning</p> <p>Indentation is important. The amount of spaces before the property must be the same.</p> <p>false example: (Fat&amp;Carbs would be a property of calories)</p> <pre><code>Banana:\ncalories: 105\n    fat: 0.4g\n    Carbs: 27 g\n</code></pre>"},{"location":"kubernetes/A5%20yaml%20k8s/Environement%20variable%20in%20yaml/","title":"Environement variable in yaml","text":"<pre><code>...\nspec:\n containers:\n - name: postgres\n   image: postgres\n   env:\n    - name: POSTGRES_PASSWORD\n      value: mysecretpassword\n</code></pre>"},{"location":"kubernetes/A5%20yaml%20k8s/Rollback/","title":"Rollback","text":"<p>When executing a rolling update and experiencing failure, it is possibe to rollback to the previous version. (Old replica set)  `kubectl rollout undo deployment/myapp-deployment</p>"},{"location":"kubernetes/A5%20yaml%20k8s/Rolling%20update%20%28Deployment%29/","title":"Rolling update (Deployment)","text":""},{"location":"kubernetes/A5%20yaml%20k8s/Rolling%20update%20%28Deployment%29/#example","title":"Example:","text":"<ul> <li>50 instances of a nginx webserver</li> <li>Users accessing that</li> <li>New nginx update release and you want it.</li> </ul> <p>By not updating all instances at once, your website never becomes unaccessible. Another advantage is the ability to roll back if errors appear during the deployment.</p> <p>Example yml</p> <p>Info</p> <p>Kubernetes deployments are above replicasets, they create them</p> <p>deployment-definition.yml <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n name: myapp-deployment\n labels:\n  app: myapp\n  type: front-end\nspec:\n  metadata:\n    name: myapp-pod\n    labels:\n          app: mini\n          isch: frontend\n   spec:\n    containers:\n        - name: nginx-container\n          image: nginx\n\n  selector:\n   matchLabels:\n    type: font-end\n</code></pre></p> <p>Create: <code>kubectl create -f deployment-definition.yml **List:**</code>kubectl get deployments Jesus: `kubectl get all</p>"},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/","title":"Rollout","text":""},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/#rollout-and-versioning","title":"Rollout and versioning","text":"<p>When doing a rollout, two versions are running at the same time.  See Status: <code>kubectl rollout status deployment/myapp-deployment **See history of rollout:**</code>kubectl rollout history deployment/myapp-depployment</p>"},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/#deployment-strategies","title":"Deployment strategies","text":""},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/#strategy-1-recreate-strategy","title":"Strategy 1 (recreate strategy:)","text":"<p>Destroy all pods and deploy new version of them:  - Sux because of downtime</p>"},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/#strategy-2-rolling-update","title":"Strategy 2 Rolling update","text":"<p>Destroy not all containers at once but one after another </p>"},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/#apply-new-deployment","title":"Apply new deployment:","text":"<ol> <li>Edit yaml</li> <li>`kubectl apply -f deployment-definition.yml</li> </ol>"},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/#info-about-deployment","title":"info about deployment","text":"<p><code>kubectl describe deployment **What kind of deployment/rollout?**</code>kubectl describe deployment | grep StrategyType</p>"},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/#edit-deployment","title":"Edit deployment:","text":"<p>`kubectl edit deployment name</p>"},{"location":"kubernetes/A5%20yaml%20k8s/Rollout/#change-to-recreate-strategy","title":"Change to recreate strategy:","text":""},{"location":"kubernetes/A5%20yaml%20k8s/Vs%20code%20ext/","title":"Vs code ext","text":""},{"location":"kubernetes/A5%20yaml%20k8s/Vs%20code%20ext/#enable-kubernetes-support","title":"Enable kubernetes support:","text":"<ol> <li>Open settings </li> <li>scroll to <code>yaml: Schemas</code> and edit settings    </li> <li>Insert this:    </li> <li>Restart vscode</li> <li>in <code>.yaml</code>file add the <code>apiVersion: v1</code> keyword to activate the extension.</li> </ol>"},{"location":"kubernetes/A5%20yaml%20k8s/yaml%20in%20kubernetes/","title":"Yaml in kubernetes","text":"<p>Best practice</p> <p>Its smart to name and label all pods in kubernetes in order to later monitor them.</p>"},{"location":"kubernetes/A5%20yaml%20k8s/yaml%20in%20kubernetes/#basic-properties","title":"Basic properties","text":"<p>Example <code>pod-definition.yml</code> <pre><code>apiVersion:\nkind:\nmetadata:\n\nspec:\n</code></pre></p>"},{"location":"kubernetes/A5%20yaml%20k8s/yaml%20in%20kubernetes/#apiversion-kind-metadata","title":"apiVersion, kind, metadata","text":"<p>Warning</p> <p>Properties are case sensitive e.g <code>kind: Pod</code></p> Property Desc Example value Example Value2 apiVersion v1 (pod/service) apps/v1 (ReplicaSet/deployment) kind kind of opject Pod, Service, ReplicaSet, Deployment metadata data about the object <code>name: any-name</code> labels: labels: under metadata <code>anything: youwant</code> spec describe containers and their image... ## Spec Example <code>pod-definition.yml</code>: 1. Create yml file: <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n    name: myapp\n    labels:\n          app: mini\n          isch: frontend\nspec:\n    containers:\n        - name: nginx-container\n          image: nginx\n        - name: database-sql-container\n           image: mysql\n</code></pre> 2. Run `kubectl create -f pod-definition.yml"},{"location":"kubernetes/A5%20yaml%20k8s/A5%20Controllers/Replication%20controller/","title":"Replication controller","text":"<p>A replication controller is responsible for checking all pods and their states. If a pod fails it creates a new one. Alternatively its possible to run multiple pods of an application for seamless transfer from a failnig pod.</p> <ul> <li>Checks if specified number of pods are running</li> <li>Load Balancing and scaling</li> <li>The replication controller can run pods according to the demand across multiple nodes.</li> <li>the in the yaml defined template pod will be replicated</li> </ul> <p>List replication controllers</p> <pre><code>kubectl get replicationcontroller\n</code></pre>"},{"location":"kubernetes/A5%20yaml%20k8s/A5%20Controllers/Replication%20controller/#replication-controller-vs-replica-sets","title":"Replication controller vs replica sets","text":"<p>Replication controller is the old way of setting up replications. The new and recommended way is replioca sets.</p>"},{"location":"kubernetes/A5%20yaml%20k8s/A5%20Controllers/delete%20replicaset%20and%20pods/","title":"Delete replicaset and pods","text":"<p><code>kubectl delete replicaset</code>mein-replicaset</p>"},{"location":"kubernetes/A5%20yaml%20k8s/A5%20Controllers/example%20replica%20set%20yaml/","title":"Example replica set yaml","text":"<pre><code>apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n name: myapp-replicaset\n labels:\n  app: myapp\n  type: front-end\nspec:\n template:\n  metadata:\n   name: myapp-pod\n   labels:\n    app: myapp\n    type: front-end\n  spec:\n   containers:\n    - name: nginx-container\n      --image: nginx\n  replicas: 3\n  selector:\n   matchLabels:\n    type: front-end\n</code></pre> <p>Tip</p> <ul> <li>If labels apply, replica sets will also consider pods not created by itself.</li> <li>The template section consists of the pod definition file</li> </ul>"},{"location":"kubernetes/A5%20yaml%20k8s/A5%20Controllers/example%20replication%20yaml/","title":"Example replication yaml","text":"<p>rc-definition.yaml <pre><code>apiVersion: v1\nkind: ReplicationController\nmetadata:\n name: myapp-rc\n labels:\n  app: myapp\n  type: front-end\nspec:\n template:\n  metadata:\n    name: myapp\n    labels:\n          app: mini\n          isch: frontend\n   spec:\n    containers:\n        - name: nginx-container\n          image: nginx\n        - name: database-sql-container\n           image: mysql\n  replicas: 3\n</code></pre></p>"},{"location":"kubernetes/A5%20yaml%20k8s/A5%20Controllers/replace%20yml%20file/","title":"Replace yml file","text":"<p>`kubectl replace -f definition.yml</p>"},{"location":"kubernetes/A5%20yaml%20k8s/A5%20Controllers/replica%20sets/","title":"Replica sets","text":"<p>example replica set yaml Not the same as Replication controller</p> <p>Create: <code>kubectl create -f file.yml list:</code>kubectl get replicaset</p>"},{"location":"kubernetes/A5%20yaml%20k8s/A5%20Controllers/replica%20sets/#labels-and-selectors","title":"Labels and selectors","text":"<p>Replica sets checks if the specified number of pods are running. It does not matter if the pods were created by the replica set or not.</p> <p>How does the replica set know which containers to count?</p> <p>By you defining labels in the <code>pod-definition.yml</code> file and using the selector: in the replica set definition: pod-definition: <pre><code>...\nmetadata:\nname: myapp-pod\nlabels:\n tier: front-end\n</code></pre> replicaset-definition.yml: <pre><code>...\nselector:\nmatchLabels:\n tier: front-end\n</code></pre></p>"},{"location":"kubernetes/A7%20Networking/Kubernetes%20on%20cloud/","title":"Kubernetes on cloud","text":""},{"location":"kubernetes/A7%20Networking/Kubernetes%20on%20cloud/#self-hosted-vs-hosted-solution","title":"Self Hosted vs Hosted solution","text":"<p>Self hosted: - Create your own VMS - Configure your own VMs - Use own scripts to deploy cluster - maintain the vms yourself - Example: Kubernetes on AWS using kops Hosted solution: - Kubernetes-As-A-Service - Provider creates vms for you - Provide installs kubernetes - Provider maintains vms - Example: Google Container Engine (GKE)</p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/101/","title":"101","text":""},{"location":"kubernetes/A7%20Networking/A5%20Networking/101/#ip-adresses","title":"Ip adresses","text":"<ul> <li>Each node gets a private ip adress (e.g 192.168.1.10)</li> <li>Each pod gets an internal ip adress (e.g 10.244.0.2)</li> <li>Pods are in the same internal network</li> </ul> <p>Accessing pods via ip</p> <p>Is a bad idea since their IP might change on recreation.</p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/101/#networking-on-multiple-nodes-in-a-cluster","title":"Networking on multiple nodes (in a cluster)","text":"<p>Example: - Node 1:     - internal network 10.244.0.0     - private ip adress 192.168.1.2     - Pod ip 10.244.0.2 - Node 2     - Internal network 10.244.0.0     - Priave ip adress 192.168.1.3     - Pod ip 10.244.0.2 </p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/101/#kubernetes-network-requirements","title":"Kubernetes network requirements","text":"<p>Warning</p> <p>This situation will cause ip conflicts which could possibly break pods. By default, kubernetes doesnt configure networks to prevent such issues. Such issues can only be prevented by fulfilling kubernetes network requirements: - All containers/PODs can communicate to one another without NAT - All nodes can communicate with all containers and vice versa without NAT Prebuild solutions meeting those requirements: </p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/ClusterIP/","title":"ClusterIP","text":"<p>Enables connectivity to pods that have a clusterip service</p> <p>Often times, multiple pods need to communicate with each other.</p> <ul> <li>Using the internal Ip adresses would be a bad idea since they are not static</li> <li>if a frontend application needs to access a backend pod, which of many replicas would it choose?</li> </ul> <p>The cluster IP service</p> <ul> <li>Makes a single interface clusterip for a group of pods so other pods can access it easily (answers which pod should be chosen (ramdom))</li> </ul>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/ClusterIP/#definition-yml","title":"Definition yml:","text":"<p><pre><code>apiVersion: v1\nkind: Service\nmetadata:\n    name: back-end\nspec:\n    type: ClusterIP\n    ports:\n        - targetPort: 80\n          port: 80\n    selector:\n        app: myapp\n        type: back-end\n</code></pre> <code>kubectl create -f service-definition.yml</code>kubectl get services</p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/Load%20Balancer/","title":"Load Balancer","text":"<p>What URL should the end user use?</p> <p>With a configured node Port service the users could access pods with the <code>ip:port</code> of any node. How can we make our pods accessible via 1 URL?</p> <p>Answer 1</p> <p>Works only on supported cloud platforms:</p> <p>Like: - Google cloud platform - AWS - microsoft azure</p> <p>update spec type in service-def.yaml: <pre><code>...\nspec\n    type: LoadBalancer\n...\n</code></pre></p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/Node%20Port%20Kubernetes%20service/","title":"Node Port Kubernetes service","text":"<p>Basics</p> <p>The node port maps a port on the node to a port on the pod - Pod in kubernetes - Listens specified port - Forwards to port on pods - Practical for mapping services to single pods</p> <p>The Port on the node (the one the user accesses) is called: - NodePort:     - Range: 30'000 - 32' 767</p> <p>The Port on the service is called: - Port</p> <p>The Port on the pod is called  - TargetPort</p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/Node%20Port%20Kubernetes%20service/#service-definition-yml","title":"Service definition yml","text":"<p>Code</p> <pre><code>api Version: v1\nkind: Service\nmetadata:\n    name: myapp-service\nspec:\n    type: NodePort\n    ports:\n     - targetPort: 80\n     port: 80\n     nodePort: 30008\n     selector:\n         app: myapp\n         type: front-end\n</code></pre> <p>Tip</p> <ul> <li>If no <code>nodePort:</code> is provided, one in the previously specified range gets automatically chosen.</li> <li>The selector is used to connect the service with the pod, replace the example values with the labels from the pod definition file.</li> <li>When multiple pods have matching labels, a random one gets chosen.</li> </ul> <p>Service</p> <p>The service by default spans across all nodes in the cluster and therefore the port gets forwarded on all nodes. (You can access the pod with <code>IpOfAnyNode:port</code>)</p> <p>Create service: `kubectl create -f service-definitino.yml List services:</p> <p>`kubectl get services</p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/Services/","title":"Services","text":""},{"location":"kubernetes/A7%20Networking/A5%20Networking/Services/#problem","title":"Problem:","text":"<p>An application in a pod in kubernetes can only be accessed on the node its running.</p> <p> If you want to - Access the website via ip of the node in the browser You need the - Kubernetes Service</p>"},{"location":"kubernetes/A7%20Networking/A5%20Networking/Services/#possible-solutions","title":"Possible Solutions:","text":"<ol> <li>Node Port Kubernetes service</li> <li>ClusterIP</li> <li>LoadBalancer</li> </ol>"},{"location":"kubernetes/A8%20Microservices%20architecture/Example%20Voting%20application/","title":"Example Voting application","text":""},{"location":"kubernetes/A8%20Microservices%20architecture/Example%20Voting%20application/#structure","title":"Structure","text":"<ul> <li>2 Interfaces (GUIS)<ul> <li>Voting-app (python)</li> <li>Result-app (nodejs)</li> </ul> </li> <li>In memory DB (Redis)</li> <li>Worker (.net)</li> <li>Database (postgres)</li> </ul>"},{"location":"kubernetes/A8%20Microservices%20architecture/Example%20Voting%20application/#in-docker-run","title":"In docker run","text":"<p><code>docker run -d --name=redis redis</code>docker run -d --name=db postgres:9.4 <code>docker run -d --namevote -p 5000:80 voting-app</code>docker run -d --name=result 5001:80 result-app `docker run -d --name=worker worker</p> <p>links</p> <ul> <li>Voting app needs redis host with hostname redis.</li> <li>Result app needs access to worker</li> <li>Worker needs access to db and redis  Add: <code>--link redis:redis</code> to voting app <code>--link db:db</code>to result-app <code>--link db:db --link redis:redis</code> Links are deprecated</li> </ul>"},{"location":"kubernetes/A8%20Microservices%20architecture/Example%20Voting%20application/#concept","title":"Concept:","text":"<p>Goals: - Deploy Containers - Enable connectivity - External access Approach (steps): 1. Deploy pods 2. Find out what pod needs to access what pod 3. Create a service (clusterip) named redis to make the redis pod accesible for other pods via its name 4. Create a service (clusterip) named db to make the db (postgres) pod accessible 5. Create Node Port Service (Voting app) 6. Create Node port service for result app</p> <p>Images</p> <p>voting-app: - kodekloud/examplevotingapp_vote:v1 result-app: - kodekloud/examplevotingapp_result:v1 redis: - Redis postgresql: - posgresql worker: - kodekloud/examplevotingapp_worker:v1</p> <p>Note</p> <p>Since the worker node is never accessed by another pod but only connects to other pods, it has no service.</p> <p></p> <p>Info</p> <p>The name redis and db are to be named redis and db because the sourcecode of the application hard coded the name.</p>"},{"location":"misc/Dictionary/Metrics/","title":"Metrics","text":"<p>Definition Metric German:</p> <p>In der Softwareentwicklung und im IT-Management bezeichnet eine Metrik eine Messung oder ein statistisches Mittel zur Quantifizierung von Softwareeigenschaften oder -leistung. Das Wort \"Metrik\" stammt von dem griechischen Wort \"metron\" ab, was \"Ma\u00df\" bedeutet.</p>"},{"location":"misc/Dictionary/aggregates/","title":"Aggregates","text":"<p>In the context of Kubernetes, \"metrics\" refers to various types of data that provide information about the performance and health of a Kubernetes cluster. \"Aggregates\", in this context, would refer to a summarized form of these metrics. This data can help administrators and developers monitor the status of the cluster and troubleshoot issues.</p>"},{"location":"misc/Dictionary/annotation/","title":"Annotation","text":"<p>a short explanation or note added to a text or image, or the act of adding short explanations or notes</p>"}]}